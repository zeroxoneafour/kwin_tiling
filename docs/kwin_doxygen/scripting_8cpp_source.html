<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>KWin: src/scripting/scripting.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">KWin
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_b49f11675e92293ffa7ceeef744893f4.html">scripting</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle"><div class="title">scripting.cpp</div></div>
</div><!--header-->
<div class="contents">
<a href="scripting_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="comment">/*</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span><span class="comment">    KWin - the KDE window manager</span></div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span><span class="comment">    This file is part of the KDE project.</span></div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span><span class="comment"></span> </div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span><span class="comment">    SPDX-FileCopyrightText: 2010 Rohan Prabhu &lt;rohan@rohanprabhu.com&gt;</span></div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span><span class="comment">    SPDX-FileCopyrightText: 2011 Martin Gräßlin &lt;mgraesslin@kde.org&gt;</span></div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span><span class="comment">    SPDX-FileCopyrightText: 2021 Vlad Zahorodnii &lt;vlad.zahorodnii@kde.org&gt;</span></div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span><span class="comment"></span> </div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span><span class="comment">    SPDX-License-Identifier: GPL-2.0-or-later</span></div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span><span class="comment">*/</span></div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span> </div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span><span class="preprocessor">#include &quot;<a class="code" href="scripting_8h.html">scripting.h</a>&quot;</span></div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span><span class="comment">// own</span></div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span><span class="preprocessor">#include &quot;<a class="code" href="dbuscall_8h.html">dbuscall.h</a>&quot;</span></div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span><span class="preprocessor">#include &quot;<a class="code" href="desktopbackgrounditem_8h.html">desktopbackgrounditem.h</a>&quot;</span></div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span><span class="preprocessor">#include &quot;<a class="code" href="quickeffect_8h.html">effect/quickeffect.h</a>&quot;</span></div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span><span class="preprocessor">#include &quot;<a class="code" href="gesturehandler_8h.html">gesturehandler.h</a>&quot;</span></div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span><span class="preprocessor">#include &quot;<a class="code" href="screenedgehandler_8h.html">screenedgehandler.h</a>&quot;</span></div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span><span class="preprocessor">#include &quot;<a class="code" href="scriptedquicksceneeffect_8h.html">scriptedquicksceneeffect.h</a>&quot;</span></div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span><span class="preprocessor">#include &quot;<a class="code" href="scripting__logging_8h.html">scripting_logging.h</a>&quot;</span></div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span><span class="preprocessor">#include &quot;<a class="code" href="scriptingutils_8h.html">scriptingutils.h</a>&quot;</span></div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span><span class="preprocessor">#include &quot;<a class="code" href="shortcuthandler_8h.html">shortcuthandler.h</a>&quot;</span></div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span><span class="preprocessor">#include &quot;<a class="code" href="virtualdesktopmodel_8h.html">virtualdesktopmodel.h</a>&quot;</span></div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span><span class="preprocessor">#include &quot;<a class="code" href="windowmodel_8h.html">windowmodel.h</a>&quot;</span></div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span><span class="preprocessor">#include &quot;<a class="code" href="windowthumbnailitem_8h.html">windowthumbnailitem.h</a>&quot;</span></div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span><span class="preprocessor">#include &quot;<a class="code" href="workspace__wrapper_8h.html">workspace_wrapper.h</a>&quot;</span></div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span> </div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span><span class="preprocessor">#include &quot;<a class="code" href="core_2output_8h.html">core/output.h</a>&quot;</span></div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span><span class="preprocessor">#include &quot;<a class="code" href="input_8h.html">input.h</a>&quot;</span></div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span><span class="preprocessor">#include &quot;<a class="code" href="options_8h.html">options.h</a>&quot;</span></div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span><span class="preprocessor">#include &quot;<a class="code" href="screenedge_8h.html">screenedge.h</a>&quot;</span></div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span><span class="preprocessor">#include &quot;<a class="code" href="tilemanager_8h.html">tiles/tilemanager.h</a>&quot;</span></div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span><span class="preprocessor">#include &quot;virtualdesktops.h&quot;</span></div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno">   34</span><span class="preprocessor">#include &quot;window.h&quot;</span></div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span><span class="preprocessor">#include &quot;<a class="code" href="workspace_8h.html">workspace.h</a>&quot;</span></div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span><span class="comment">// KDE</span></div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span><span class="preprocessor">#include &lt;KConfigGroup&gt;</span></div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span><span class="preprocessor">#include &lt;KConfigPropertyMap&gt;</span></div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span><span class="preprocessor">#include &lt;KGlobalAccel&gt;</span></div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span><span class="preprocessor">#include &lt;KLocalizedContext&gt;</span></div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno">   41</span><span class="preprocessor">#include &lt;KPackage/PackageLoader&gt;</span></div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span><span class="comment">// Qt</span></div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span><span class="preprocessor">#include &lt;QDBusConnection&gt;</span></div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span><span class="preprocessor">#include &lt;QDBusPendingCallWatcher&gt;</span></div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span><span class="preprocessor">#include &lt;QDebug&gt;</span></div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span><span class="preprocessor">#include &lt;QFutureWatcher&gt;</span></div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span><span class="preprocessor">#include &lt;QMenu&gt;</span></div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span><span class="preprocessor">#include &lt;QQmlContext&gt;</span></div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span><span class="preprocessor">#include &lt;QQmlEngine&gt;</span></div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span><span class="preprocessor">#include &lt;QQmlExpression&gt;</span></div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span><span class="preprocessor">#include &lt;QQuickWindow&gt;</span></div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span><span class="preprocessor">#include &lt;QSettings&gt;</span></div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span><span class="preprocessor">#include &lt;QStandardPaths&gt;</span></div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span><span class="preprocessor">#include &lt;QtConcurrentRun&gt;</span></div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span> </div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span><span class="preprocessor">#include &quot;scriptadaptor.h&quot;</span></div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span> </div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span><span class="keyword">static</span> QRect scriptValueToRect(<span class="keyword">const</span> QJSValue &amp;value)</div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span>{</div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span>    <span class="keywordflow">return</span> QRect(value.property(QStringLiteral(<span class="stringliteral">&quot;x&quot;</span>)).toInt(),</div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span>                 value.property(QStringLiteral(<span class="stringliteral">&quot;y&quot;</span>)).toInt(),</div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span>                 value.property(QStringLiteral(<span class="stringliteral">&quot;width&quot;</span>)).toInt(),</div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span>                 value.property(QStringLiteral(<span class="stringliteral">&quot;height&quot;</span>)).toInt());</div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span>}</div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span> </div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span><span class="keyword">static</span> QRectF scriptValueToRectF(<span class="keyword">const</span> QJSValue &amp;value)</div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span>{</div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span>    <span class="keywordflow">return</span> QRectF(value.property(QStringLiteral(<span class="stringliteral">&quot;x&quot;</span>)).toNumber(),</div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span>                  value.property(QStringLiteral(<span class="stringliteral">&quot;y&quot;</span>)).toNumber(),</div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span>                  value.property(QStringLiteral(<span class="stringliteral">&quot;width&quot;</span>)).toNumber(),</div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span>                  value.property(QStringLiteral(<span class="stringliteral">&quot;height&quot;</span>)).toNumber());</div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span>}</div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span> </div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span><span class="keyword">static</span> QPoint scriptValueToPoint(<span class="keyword">const</span> QJSValue &amp;value)</div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span>{</div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span>    <span class="keywordflow">return</span> QPoint(value.property(QStringLiteral(<span class="stringliteral">&quot;x&quot;</span>)).toInt(),</div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span>                  value.property(QStringLiteral(<span class="stringliteral">&quot;y&quot;</span>)).toInt());</div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span>}</div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span> </div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span><span class="keyword">static</span> QPointF scriptValueToPointF(<span class="keyword">const</span> QJSValue &amp;value)</div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span>{</div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span>    <span class="keywordflow">return</span> QPointF(value.property(QStringLiteral(<span class="stringliteral">&quot;x&quot;</span>)).toNumber(),</div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span>                   value.property(QStringLiteral(<span class="stringliteral">&quot;y&quot;</span>)).toNumber());</div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span>}</div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span> </div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span><span class="keyword">static</span> QSize scriptValueToSize(<span class="keyword">const</span> QJSValue &amp;value)</div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span>{</div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span>    <span class="keywordflow">return</span> QSize(value.property(QStringLiteral(<span class="stringliteral">&quot;width&quot;</span>)).toInt(),</div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span>                 value.property(QStringLiteral(<span class="stringliteral">&quot;height&quot;</span>)).toInt());</div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span>}</div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span> </div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span><span class="keyword">static</span> QSizeF scriptValueToSizeF(<span class="keyword">const</span> QJSValue &amp;value)</div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span>{</div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span>    <span class="keywordflow">return</span> QSizeF(value.property(QStringLiteral(<span class="stringliteral">&quot;width&quot;</span>)).toNumber(),</div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span>                  value.property(QStringLiteral(<span class="stringliteral">&quot;height&quot;</span>)).toNumber());</div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span>}</div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span> </div>
<div class="foldopen" id="foldopen00098" data-start="{" data-end="}">
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno"><a class="line" href="class_k_win_1_1_abstract_script.html#a76d921a0d06d2d9e3783739c683225d5">   98</a></span><a class="code hl_function" href="class_k_win_1_1_abstract_script.html#a76d921a0d06d2d9e3783739c683225d5">KWin::AbstractScript::AbstractScript</a>(<span class="keywordtype">int</span> <span class="keywordtype">id</span>, QString scriptName, QString pluginName, QObject *parent)</div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno">   99</span>    : QObject(parent)</div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span>    , m_scriptId(id)</div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span>    , m_fileName(scriptName)</div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno">  102</span>    , m_pluginName(pluginName)</div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno">  103</span>    , m_running(false)</div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno">  104</span>{</div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno">  105</span>    <span class="keywordflow">if</span> (m_pluginName.isNull()) {</div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span>        m_pluginName = scriptName;</div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno">  107</span>    }</div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span> </div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span>    <span class="keyword">new</span> ScriptAdaptor(<span class="keyword">this</span>);</div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span>    QDBusConnection::sessionBus().registerObject(QStringLiteral(<span class="stringliteral">&quot;/Scripting/Script&quot;</span>) + QString::number(<a class="code hl_function" href="class_k_win_1_1_abstract_script.html#ae8f1f9aa3f49d4ff42404fcc272ab4f5">scriptId</a>()), <span class="keyword">this</span>, QDBusConnection::ExportAdaptors);</div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno">  111</span>}</div>
</div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno">  112</span> </div>
<div class="foldopen" id="foldopen00113" data-start="{" data-end="}">
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno"><a class="line" href="class_k_win_1_1_abstract_script.html#afac9b3c7d793923982af2b2919bca2c8">  113</a></span><a class="code hl_function" href="class_k_win_1_1_abstract_script.html#afac9b3c7d793923982af2b2919bca2c8">KWin::AbstractScript::~AbstractScript</a>()</div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span>{</div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span>}</div>
</div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span> </div>
<div class="foldopen" id="foldopen00117" data-start="{" data-end="}">
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno"><a class="line" href="class_k_win_1_1_abstract_script.html#adedebe311021f5d95fe467faeffca8dc">  117</a></span>KConfigGroup <a class="code hl_function" href="class_k_win_1_1_abstract_script.html#adedebe311021f5d95fe467faeffca8dc">KWin::AbstractScript::config</a>()<span class="keyword"> const</span></div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span><span class="keyword"></span>{</div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno">  119</span>    <span class="keywordflow">return</span> kwinApp()-&gt;config()-&gt;group(QLatin1String(<span class="stringliteral">&quot;Script-&quot;</span>) + m_pluginName);</div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span>}</div>
</div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno">  121</span> </div>
<div class="foldopen" id="foldopen00122" data-start="{" data-end="}">
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno"><a class="line" href="class_k_win_1_1_abstract_script.html#ad09c6008ab7e5629b49af42a3bf3271d">  122</a></span><span class="keywordtype">void</span> <a class="code hl_slot" href="class_k_win_1_1_abstract_script.html#ad09c6008ab7e5629b49af42a3bf3271d">KWin::AbstractScript::stop</a>()</div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span>{</div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno">  124</span>    deleteLater();</div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno">  125</span>}</div>
</div>
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno">  126</span> </div>
<div class="foldopen" id="foldopen00127" data-start="{" data-end="}">
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno"><a class="line" href="class_k_win_1_1_script_timer.html#ae556302e470671be322137dae9cbe0c4">  127</a></span><a class="code hl_function" href="class_k_win_1_1_script_timer.html#ae556302e470671be322137dae9cbe0c4">KWin::ScriptTimer::ScriptTimer</a>(QObject *parent)</div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno">  128</span>    : QTimer(parent)</div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno">  129</span>{</div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno">  130</span>}</div>
</div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno">  131</span> </div>
<div class="foldopen" id="foldopen00132" data-start="{" data-end="}">
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno"><a class="line" href="class_k_win_1_1_script.html#a5386a6cb0c28b8bdf1538adc8808fac9">  132</a></span><a class="code hl_function" href="class_k_win_1_1_script.html#a5386a6cb0c28b8bdf1538adc8808fac9">KWin::Script::Script</a>(<span class="keywordtype">int</span> <span class="keywordtype">id</span>, QString scriptName, QString pluginName, QObject *parent)</div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno">  133</span>    : <a class="code hl_class" href="class_k_win_1_1_abstract_script.html">AbstractScript</a>(id, scriptName, pluginName, parent)</div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno">  134</span>    , m_engine(new QJSEngine(this))</div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span>    , m_starting(false)</div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span>{</div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno">  137</span>    <span class="comment">// TODO: Remove in kwin 6. We have these converters only for compatibility reasons.</span></div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span>    <span class="keywordflow">if</span> (!QMetaType::hasRegisteredConverterFunction&lt;QJSValue, QRect&gt;()) {</div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span>        QMetaType::registerConverter&lt;QJSValue, QRect&gt;(scriptValueToRect);</div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span>    }</div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span>    <span class="keywordflow">if</span> (!QMetaType::hasRegisteredConverterFunction&lt;QJSValue, QRectF&gt;()) {</div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno">  142</span>        QMetaType::registerConverter&lt;QJSValue, QRectF&gt;(scriptValueToRectF);</div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno">  143</span>    }</div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span> </div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno">  145</span>    <span class="keywordflow">if</span> (!QMetaType::hasRegisteredConverterFunction&lt;QJSValue, QPoint&gt;()) {</div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno">  146</span>        QMetaType::registerConverter&lt;QJSValue, QPoint&gt;(scriptValueToPoint);</div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno">  147</span>    }</div>
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno">  148</span>    <span class="keywordflow">if</span> (!QMetaType::hasRegisteredConverterFunction&lt;QJSValue, QPointF&gt;()) {</div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span>        QMetaType::registerConverter&lt;QJSValue, QPointF&gt;(scriptValueToPointF);</div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno">  150</span>    }</div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span> </div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span>    <span class="keywordflow">if</span> (!QMetaType::hasRegisteredConverterFunction&lt;QJSValue, QSize&gt;()) {</div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span>        QMetaType::registerConverter&lt;QJSValue, QSize&gt;(scriptValueToSize);</div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span>    }</div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span>    <span class="keywordflow">if</span> (!QMetaType::hasRegisteredConverterFunction&lt;QJSValue, QSizeF&gt;()) {</div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span>        QMetaType::registerConverter&lt;QJSValue, QSizeF&gt;(scriptValueToSizeF);</div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span>    }</div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno">  158</span>}</div>
</div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span> </div>
<div class="foldopen" id="foldopen00160" data-start="{" data-end="}">
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno"><a class="line" href="class_k_win_1_1_script.html#a86b6b20a771b7f03a51e127b2dca4459">  160</a></span><a class="code hl_function" href="class_k_win_1_1_script.html#a86b6b20a771b7f03a51e127b2dca4459">KWin::Script::~Script</a>()</div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span>{</div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span>}</div>
</div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span> </div>
<div class="foldopen" id="foldopen00164" data-start="{" data-end="}">
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno"><a class="line" href="class_k_win_1_1_script.html#a5f98b562df6f7281531e4baaac9f7bfa">  164</a></span><span class="keywordtype">void</span> <a class="code hl_slot" href="class_k_win_1_1_script.html#a5f98b562df6f7281531e4baaac9f7bfa">KWin::Script::run</a>()</div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span>{</div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span>    <span class="keywordflow">if</span> (running() || m_starting) {</div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno">  167</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span>    }</div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno">  169</span> </div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span>    <span class="keywordflow">if</span> (calledFromDBus()) {</div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno">  171</span>        m_invocationContext = message();</div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno">  172</span>        setDelayedReply(<span class="keyword">true</span>);</div>
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno">  173</span>    }</div>
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno">  174</span> </div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno">  175</span>    m_starting = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno">  176</span>    <a class="code hl_class" href="class_q_future_watcher.html">QFutureWatcher&lt;QByteArray&gt;</a> *watcher = <span class="keyword">new</span> <a class="code hl_class" href="class_q_future_watcher.html">QFutureWatcher&lt;QByteArray&gt;</a>(<span class="keyword">this</span>);</div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno">  177</span>    connect(watcher, &amp;QFutureWatcherBase::finished, <span class="keyword">this</span>, &amp;Script::slotScriptLoadedFromFile);</div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno">  178</span>    watcher-&gt;setFuture(QtConcurrent::run(&amp;KWin::Script::loadScriptFromFile, <span class="keyword">this</span>, fileName()));</div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span>}</div>
</div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span> </div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno">  181</span>QByteArray KWin::Script::loadScriptFromFile(<span class="keyword">const</span> QString &amp;fileName)</div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span>{</div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span>    QFile file(fileName);</div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span>    <span class="keywordflow">if</span> (!file.open(QIODevice::ReadOnly)) {</div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno">  185</span>        <span class="keywordflow">return</span> QByteArray();</div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span>    }</div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span>    QByteArray result(file.readAll());</div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span>    <span class="keywordflow">return</span> result;</div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span>}</div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span> </div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span><span class="keywordtype">void</span> KWin::Script::slotScriptLoadedFromFile()</div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span>{</div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno">  193</span>    <a class="code hl_class" href="class_q_future_watcher.html">QFutureWatcher&lt;QByteArray&gt;</a> *watcher = <span class="keyword">dynamic_cast&lt;</span><a class="code hl_class" href="class_q_future_watcher.html">QFutureWatcher&lt;QByteArray&gt;</a> *<span class="keyword">&gt;</span>(sender());</div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span>    <span class="keywordflow">if</span> (!watcher) {</div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span>        <span class="comment">// not invoked from a QFutureWatcher</span></div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span>    }</div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span>    <span class="keywordflow">if</span> (watcher-&gt;result().isNull()) {</div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno">  199</span>        <span class="comment">// do not load empty script</span></div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span>        deleteLater();</div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno">  201</span>        watcher-&gt;deleteLater();</div>
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno">  202</span> </div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno">  203</span>        <span class="keywordflow">if</span> (m_invocationContext.type() == QDBusMessage::MethodCallMessage) {</div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno">  204</span>            <span class="keyword">auto</span> reply = m_invocationContext.createErrorReply(<span class="stringliteral">&quot;org.kde.kwin.Scripting.FileError&quot;</span>, QString(<span class="stringliteral">&quot;Could not open %1&quot;</span>).arg(fileName()));</div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span>            QDBusConnection::sessionBus().send(reply);</div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno">  206</span>            m_invocationContext = QDBusMessage();</div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno">  207</span>        }</div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span> </div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span>    }</div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span> </div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span>    <span class="comment">// Install console functions (e.g. console.assert(), console.log(), etc).</span></div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span>    m_engine-&gt;installExtensions(QJSEngine::ConsoleExtension);</div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno">  214</span> </div>
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno">  215</span>    <span class="comment">// Make the timer visible to QJSEngine.</span></div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno">  216</span>    QJSValue timerMetaObject = m_engine-&gt;newQMetaObject(&amp;ScriptTimer::staticMetaObject);</div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno">  217</span>    m_engine-&gt;globalObject().setProperty(<span class="stringliteral">&quot;QTimer&quot;</span>, timerMetaObject);</div>
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno">  218</span> </div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span>    <span class="comment">// Expose enums.</span></div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span>    m_engine-&gt;globalObject().setProperty(QStringLiteral(<span class="stringliteral">&quot;KWin&quot;</span>), m_engine-&gt;newQMetaObject(&amp;QtScriptWorkspaceWrapper::staticMetaObject));</div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span> </div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span>    <span class="comment">// Make the options object visible to QJSEngine.</span></div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span>    QJSValue optionsObject = m_engine-&gt;newQObject(<a class="code hl_variable" href="namespace_k_win.html#aacddce7916a99bb943d9071c40754c1c">options</a>);</div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno">  224</span>    QQmlEngine::setObjectOwnership(<a class="code hl_variable" href="namespace_k_win.html#aacddce7916a99bb943d9071c40754c1c">options</a>, QQmlEngine::CppOwnership);</div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno">  225</span>    m_engine-&gt;globalObject().setProperty(QStringLiteral(<span class="stringliteral">&quot;options&quot;</span>), optionsObject);</div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno">  226</span> </div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno">  227</span>    <span class="comment">// Make the workspace visible to QJSEngine.</span></div>
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno">  228</span>    QJSValue workspaceObject = m_engine-&gt;newQObject(<a class="code hl_function" href="class_k_win_1_1_scripting.html#ae42e35c69eacf6822dccda0b351fdc84">Scripting::self</a>()-&gt;workspaceWrapper());</div>
<div class="line"><a id="l00229" name="l00229"></a><span class="lineno">  229</span>    QQmlEngine::setObjectOwnership(<a class="code hl_function" href="class_k_win_1_1_scripting.html#ae42e35c69eacf6822dccda0b351fdc84">Scripting::self</a>()-&gt;workspaceWrapper(), QQmlEngine::CppOwnership);</div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno">  230</span>    m_engine-&gt;globalObject().setProperty(QStringLiteral(<span class="stringliteral">&quot;workspace&quot;</span>), workspaceObject);</div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno">  231</span> </div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno">  232</span>    QJSValue self = m_engine-&gt;newQObject(<span class="keyword">this</span>);</div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span>    QQmlEngine::setObjectOwnership(<span class="keyword">this</span>, QQmlEngine::CppOwnership);</div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno">  234</span> </div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span>    <span class="keyword">static</span> <span class="keyword">const</span> QStringList globalProperties{</div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span>        QStringLiteral(<span class="stringliteral">&quot;readConfig&quot;</span>),</div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span>        QStringLiteral(<span class="stringliteral">&quot;callDBus&quot;</span>),</div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span> </div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span>        QStringLiteral(<span class="stringliteral">&quot;registerShortcut&quot;</span>),</div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span>        QStringLiteral(<span class="stringliteral">&quot;registerScreenEdge&quot;</span>),</div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span>        QStringLiteral(<span class="stringliteral">&quot;unregisterScreenEdge&quot;</span>),</div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span>        QStringLiteral(<span class="stringliteral">&quot;registerTouchScreenEdge&quot;</span>),</div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno">  243</span>        QStringLiteral(<span class="stringliteral">&quot;unregisterTouchScreenEdge&quot;</span>),</div>
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno">  244</span>        QStringLiteral(<span class="stringliteral">&quot;registerUserActionsMenu&quot;</span>),</div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno">  245</span>    };</div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno">  246</span> </div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno">  247</span>    <span class="keywordflow">for</span> (<span class="keyword">const</span> QString &amp;propertyName : globalProperties) {</div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span>        m_engine-&gt;globalObject().setProperty(propertyName, self.property(propertyName));</div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno">  249</span>    }</div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno">  250</span> </div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno">  251</span>    <span class="comment">// Inject assertion functions. It would be better to create a module with all</span></div>
<div class="line"><a id="l00252" name="l00252"></a><span class="lineno">  252</span>    <span class="comment">// this assert functions or just deprecate them in favor of console.assert().</span></div>
<div class="line"><a id="l00253" name="l00253"></a><span class="lineno">  253</span>    QJSValue result = m_engine-&gt;evaluate(QStringLiteral(R<span class="stringliteral">&quot;(</span></div>
<div class="line"><a id="l00254" name="l00254"></a><span class="lineno">  254</span><span class="stringliteral">        function assert(condition, message) {</span></div>
<div class="line"><a id="l00255" name="l00255"></a><span class="lineno">  255</span><span class="stringliteral">            console.assert(condition, message || &#39;Assertion failed&#39;);</span></div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno">  256</span><span class="stringliteral">        }</span></div>
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno">  257</span><span class="stringliteral">        function assertTrue(condition, message) {</span></div>
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno">  258</span><span class="stringliteral">            console.assert(condition, message || &#39;Assertion failed&#39;);</span></div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno">  259</span><span class="stringliteral">        }</span></div>
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno">  260</span><span class="stringliteral">        function assertFalse(condition, message) {</span></div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno">  261</span><span class="stringliteral">            console.assert(!condition, message || &#39;Assertion failed&#39;);</span></div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno">  262</span><span class="stringliteral">        }</span></div>
<div class="line"><a id="l00263" name="l00263"></a><span class="lineno">  263</span><span class="stringliteral">        function assertNull(value, message) {</span></div>
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno">  264</span><span class="stringliteral">            console.assert(value === null, message || &#39;Assertion failed&#39;);</span></div>
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno">  265</span><span class="stringliteral">        }</span></div>
<div class="line"><a id="l00266" name="l00266"></a><span class="lineno">  266</span><span class="stringliteral">        function assertNotNull(value, message) {</span></div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno">  267</span><span class="stringliteral">            console.assert(value !== null, message || &#39;Assertion failed&#39;);</span></div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno">  268</span><span class="stringliteral">        }</span></div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno">  269</span><span class="stringliteral">        function assertEquals(expected, actual, message) {</span></div>
<div class="line"><a id="l00270" name="l00270"></a><span class="lineno">  270</span><span class="stringliteral">            console.assert(expected === actual, message || &#39;Assertion failed&#39;);</span></div>
<div class="line"><a id="l00271" name="l00271"></a><span class="lineno">  271</span><span class="stringliteral">        }</span></div>
<div class="line"><a id="l00272" name="l00272"></a><span class="lineno">  272</span><span class="stringliteral">    )&quot;));</span></div>
<div class="line"><a id="l00273" name="l00273"></a><span class="lineno">  273</span><span class="stringliteral">    Q_ASSERT(!result.isError());</span></div>
<div class="line"><a id="l00274" name="l00274"></a><span class="lineno">  274</span><span class="stringliteral"></span> </div>
<div class="line"><a id="l00275" name="l00275"></a><span class="lineno">  275</span><span class="stringliteral">    result = m_engine-&gt;evaluate(QString::fromUtf8(watcher-&gt;result()), fileName());</span></div>
<div class="line"><a id="l00276" name="l00276"></a><span class="lineno">  276</span><span class="stringliteral">    </span><span class="keywordflow">if</span> (result.isError()) {</div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno">  277</span>        qCWarning(KWIN_SCRIPTING, <span class="stringliteral">&quot;%s:%d: error: %s&quot;</span>, qPrintable(fileName()),</div>
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno">  278</span>                  result.property(QStringLiteral(<span class="stringliteral">&quot;lineNumber&quot;</span>)).toInt(),</div>
<div class="line"><a id="l00279" name="l00279"></a><span class="lineno">  279</span>                  qPrintable(result.property(QStringLiteral(<span class="stringliteral">&quot;message&quot;</span>)).toString()));</div>
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno">  280</span>        deleteLater();</div>
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno">  281</span>    }</div>
<div class="line"><a id="l00282" name="l00282"></a><span class="lineno">  282</span> </div>
<div class="line"><a id="l00283" name="l00283"></a><span class="lineno">  283</span>    <span class="keywordflow">if</span> (m_invocationContext.type() == QDBusMessage::MethodCallMessage) {</div>
<div class="line"><a id="l00284" name="l00284"></a><span class="lineno">  284</span>        <span class="keyword">auto</span> reply = m_invocationContext.createReply();</div>
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno">  285</span>        QDBusConnection::sessionBus().send(reply);</div>
<div class="line"><a id="l00286" name="l00286"></a><span class="lineno">  286</span>        m_invocationContext = QDBusMessage();</div>
<div class="line"><a id="l00287" name="l00287"></a><span class="lineno">  287</span>    }</div>
<div class="line"><a id="l00288" name="l00288"></a><span class="lineno">  288</span> </div>
<div class="line"><a id="l00289" name="l00289"></a><span class="lineno">  289</span>    watcher-&gt;deleteLater();</div>
<div class="line"><a id="l00290" name="l00290"></a><span class="lineno">  290</span>    setRunning(<span class="keyword">true</span>);</div>
<div class="line"><a id="l00291" name="l00291"></a><span class="lineno">  291</span>    m_starting = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00292" name="l00292"></a><span class="lineno">  292</span>}</div>
<div class="line"><a id="l00293" name="l00293"></a><span class="lineno">  293</span> </div>
<div class="foldopen" id="foldopen00294" data-start="{" data-end="}">
<div class="line"><a id="l00294" name="l00294"></a><span class="lineno"><a class="line" href="class_k_win_1_1_script.html#a21611e13f0afa92b37842baf67294599">  294</a></span>QVariant <a class="code hl_function" href="class_k_win_1_1_script.html#a21611e13f0afa92b37842baf67294599">KWin::Script::readConfig</a>(<span class="keyword">const</span> QString &amp;key, <span class="keyword">const</span> QVariant &amp;defaultValue)</div>
<div class="line"><a id="l00295" name="l00295"></a><span class="lineno">  295</span>{</div>
<div class="line"><a id="l00296" name="l00296"></a><span class="lineno">  296</span>    <span class="keywordflow">return</span> config().readEntry(key, defaultValue);</div>
<div class="line"><a id="l00297" name="l00297"></a><span class="lineno">  297</span>}</div>
</div>
<div class="line"><a id="l00298" name="l00298"></a><span class="lineno">  298</span> </div>
<div class="foldopen" id="foldopen00299" data-start="{" data-end="}">
<div class="line"><a id="l00299" name="l00299"></a><span class="lineno"><a class="line" href="class_k_win_1_1_script.html#a585c5d02390b9e2b6ae7f77fbfdf4e4a">  299</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="class_k_win_1_1_script.html#a585c5d02390b9e2b6ae7f77fbfdf4e4a">KWin::Script::callDBus</a>(<span class="keyword">const</span> QString &amp;service, <span class="keyword">const</span> QString &amp;path, <span class="keyword">const</span> QString &amp;interface,</div>
<div class="line"><a id="l00300" name="l00300"></a><span class="lineno">  300</span>                            <span class="keyword">const</span> QString &amp;method, <span class="keyword">const</span> QJSValue &amp;arg1, <span class="keyword">const</span> QJSValue &amp;arg2,</div>
<div class="line"><a id="l00301" name="l00301"></a><span class="lineno">  301</span>                            <span class="keyword">const</span> QJSValue &amp;arg3, <span class="keyword">const</span> QJSValue &amp;arg4, <span class="keyword">const</span> QJSValue &amp;arg5,</div>
<div class="line"><a id="l00302" name="l00302"></a><span class="lineno">  302</span>                            <span class="keyword">const</span> QJSValue &amp;arg6, <span class="keyword">const</span> QJSValue &amp;arg7, <span class="keyword">const</span> QJSValue &amp;arg8,</div>
<div class="line"><a id="l00303" name="l00303"></a><span class="lineno">  303</span>                            <span class="keyword">const</span> QJSValue &amp;arg9)</div>
<div class="line"><a id="l00304" name="l00304"></a><span class="lineno">  304</span>{</div>
<div class="line"><a id="l00305" name="l00305"></a><span class="lineno">  305</span>    QJSValueList jsArguments;</div>
<div class="line"><a id="l00306" name="l00306"></a><span class="lineno">  306</span>    jsArguments.reserve(9);</div>
<div class="line"><a id="l00307" name="l00307"></a><span class="lineno">  307</span> </div>
<div class="line"><a id="l00308" name="l00308"></a><span class="lineno">  308</span>    <span class="keywordflow">if</span> (!arg1.isUndefined()) {</div>
<div class="line"><a id="l00309" name="l00309"></a><span class="lineno">  309</span>        jsArguments &lt;&lt; arg1;</div>
<div class="line"><a id="l00310" name="l00310"></a><span class="lineno">  310</span>    }</div>
<div class="line"><a id="l00311" name="l00311"></a><span class="lineno">  311</span>    <span class="keywordflow">if</span> (!arg2.isUndefined()) {</div>
<div class="line"><a id="l00312" name="l00312"></a><span class="lineno">  312</span>        jsArguments &lt;&lt; arg2;</div>
<div class="line"><a id="l00313" name="l00313"></a><span class="lineno">  313</span>    }</div>
<div class="line"><a id="l00314" name="l00314"></a><span class="lineno">  314</span>    <span class="keywordflow">if</span> (!arg3.isUndefined()) {</div>
<div class="line"><a id="l00315" name="l00315"></a><span class="lineno">  315</span>        jsArguments &lt;&lt; arg3;</div>
<div class="line"><a id="l00316" name="l00316"></a><span class="lineno">  316</span>    }</div>
<div class="line"><a id="l00317" name="l00317"></a><span class="lineno">  317</span>    <span class="keywordflow">if</span> (!arg4.isUndefined()) {</div>
<div class="line"><a id="l00318" name="l00318"></a><span class="lineno">  318</span>        jsArguments &lt;&lt; arg4;</div>
<div class="line"><a id="l00319" name="l00319"></a><span class="lineno">  319</span>    }</div>
<div class="line"><a id="l00320" name="l00320"></a><span class="lineno">  320</span>    <span class="keywordflow">if</span> (!arg5.isUndefined()) {</div>
<div class="line"><a id="l00321" name="l00321"></a><span class="lineno">  321</span>        jsArguments &lt;&lt; arg5;</div>
<div class="line"><a id="l00322" name="l00322"></a><span class="lineno">  322</span>    }</div>
<div class="line"><a id="l00323" name="l00323"></a><span class="lineno">  323</span>    <span class="keywordflow">if</span> (!arg6.isUndefined()) {</div>
<div class="line"><a id="l00324" name="l00324"></a><span class="lineno">  324</span>        jsArguments &lt;&lt; arg6;</div>
<div class="line"><a id="l00325" name="l00325"></a><span class="lineno">  325</span>    }</div>
<div class="line"><a id="l00326" name="l00326"></a><span class="lineno">  326</span>    <span class="keywordflow">if</span> (!arg7.isUndefined()) {</div>
<div class="line"><a id="l00327" name="l00327"></a><span class="lineno">  327</span>        jsArguments &lt;&lt; arg7;</div>
<div class="line"><a id="l00328" name="l00328"></a><span class="lineno">  328</span>    }</div>
<div class="line"><a id="l00329" name="l00329"></a><span class="lineno">  329</span>    <span class="keywordflow">if</span> (!arg8.isUndefined()) {</div>
<div class="line"><a id="l00330" name="l00330"></a><span class="lineno">  330</span>        jsArguments &lt;&lt; arg8;</div>
<div class="line"><a id="l00331" name="l00331"></a><span class="lineno">  331</span>    }</div>
<div class="line"><a id="l00332" name="l00332"></a><span class="lineno">  332</span>    <span class="keywordflow">if</span> (!arg9.isUndefined()) {</div>
<div class="line"><a id="l00333" name="l00333"></a><span class="lineno">  333</span>        jsArguments &lt;&lt; arg9;</div>
<div class="line"><a id="l00334" name="l00334"></a><span class="lineno">  334</span>    }</div>
<div class="line"><a id="l00335" name="l00335"></a><span class="lineno">  335</span> </div>
<div class="line"><a id="l00336" name="l00336"></a><span class="lineno">  336</span>    QJSValue callback;</div>
<div class="line"><a id="l00337" name="l00337"></a><span class="lineno">  337</span>    <span class="keywordflow">if</span> (!jsArguments.isEmpty() &amp;&amp; jsArguments.last().isCallable()) {</div>
<div class="line"><a id="l00338" name="l00338"></a><span class="lineno">  338</span>        callback = jsArguments.takeLast();</div>
<div class="line"><a id="l00339" name="l00339"></a><span class="lineno">  339</span>    }</div>
<div class="line"><a id="l00340" name="l00340"></a><span class="lineno">  340</span> </div>
<div class="line"><a id="l00341" name="l00341"></a><span class="lineno">  341</span>    QVariantList dbusArguments;</div>
<div class="line"><a id="l00342" name="l00342"></a><span class="lineno">  342</span>    dbusArguments.reserve(jsArguments.count());</div>
<div class="line"><a id="l00343" name="l00343"></a><span class="lineno">  343</span>    <span class="keywordflow">for</span> (<span class="keyword">const</span> QJSValue &amp;jsArgument : std::as_const(jsArguments)) {</div>
<div class="line"><a id="l00344" name="l00344"></a><span class="lineno">  344</span>        dbusArguments &lt;&lt; jsArgument.toVariant();</div>
<div class="line"><a id="l00345" name="l00345"></a><span class="lineno">  345</span>    }</div>
<div class="line"><a id="l00346" name="l00346"></a><span class="lineno">  346</span> </div>
<div class="line"><a id="l00347" name="l00347"></a><span class="lineno">  347</span>    QDBusMessage message = QDBusMessage::createMethodCall(service, path, interface, method);</div>
<div class="line"><a id="l00348" name="l00348"></a><span class="lineno">  348</span>    message.setArguments(dbusArguments);</div>
<div class="line"><a id="l00349" name="l00349"></a><span class="lineno">  349</span> </div>
<div class="line"><a id="l00350" name="l00350"></a><span class="lineno">  350</span>    <span class="keyword">const</span> QDBusPendingCall call = QDBusConnection::sessionBus().asyncCall(message);</div>
<div class="line"><a id="l00351" name="l00351"></a><span class="lineno">  351</span>    <span class="keywordflow">if</span> (callback.isUndefined()) {</div>
<div class="line"><a id="l00352" name="l00352"></a><span class="lineno">  352</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00353" name="l00353"></a><span class="lineno">  353</span>    }</div>
<div class="line"><a id="l00354" name="l00354"></a><span class="lineno">  354</span> </div>
<div class="line"><a id="l00355" name="l00355"></a><span class="lineno">  355</span>    QDBusPendingCallWatcher *watcher = <span class="keyword">new</span> QDBusPendingCallWatcher(call, <span class="keyword">this</span>);</div>
<div class="line"><a id="l00356" name="l00356"></a><span class="lineno">  356</span>    connect(watcher, &amp;QDBusPendingCallWatcher::finished, <span class="keyword">this</span>, [<span class="keyword">this</span>, callback](QDBusPendingCallWatcher *self) {</div>
<div class="line"><a id="l00357" name="l00357"></a><span class="lineno">  357</span>        self-&gt;deleteLater();</div>
<div class="line"><a id="l00358" name="l00358"></a><span class="lineno">  358</span> </div>
<div class="line"><a id="l00359" name="l00359"></a><span class="lineno">  359</span>        <span class="keywordflow">if</span> (self-&gt;isError()) {</div>
<div class="line"><a id="l00360" name="l00360"></a><span class="lineno">  360</span>            qCWarning(KWIN_SCRIPTING) &lt;&lt; <span class="stringliteral">&quot;Received D-Bus message is error:&quot;</span> &lt;&lt; self-&gt;error().message();</div>
<div class="line"><a id="l00361" name="l00361"></a><span class="lineno">  361</span>            return;</div>
<div class="line"><a id="l00362" name="l00362"></a><span class="lineno">  362</span>        }</div>
<div class="line"><a id="l00363" name="l00363"></a><span class="lineno">  363</span> </div>
<div class="line"><a id="l00364" name="l00364"></a><span class="lineno">  364</span>        QJSValueList arguments;</div>
<div class="line"><a id="l00365" name="l00365"></a><span class="lineno">  365</span>        <span class="keyword">const</span> QVariantList reply = self-&gt;reply().arguments();</div>
<div class="line"><a id="l00366" name="l00366"></a><span class="lineno">  366</span>        <span class="keywordflow">for</span> (<span class="keyword">const</span> QVariant &amp;variant : reply) {</div>
<div class="line"><a id="l00367" name="l00367"></a><span class="lineno">  367</span>            arguments &lt;&lt; m_engine-&gt;toScriptValue(<a class="code hl_function" href="namespace_k_win.html#a19449039799dcafb994719a68964b51e">dbusToVariant</a>(variant));</div>
<div class="line"><a id="l00368" name="l00368"></a><span class="lineno">  368</span>        }</div>
<div class="line"><a id="l00369" name="l00369"></a><span class="lineno">  369</span> </div>
<div class="line"><a id="l00370" name="l00370"></a><span class="lineno">  370</span>        QJSValue(callback).call(arguments);</div>
<div class="line"><a id="l00371" name="l00371"></a><span class="lineno">  371</span>    });</div>
<div class="line"><a id="l00372" name="l00372"></a><span class="lineno">  372</span>}</div>
</div>
<div class="line"><a id="l00373" name="l00373"></a><span class="lineno">  373</span> </div>
<div class="foldopen" id="foldopen00374" data-start="{" data-end="}">
<div class="line"><a id="l00374" name="l00374"></a><span class="lineno"><a class="line" href="class_k_win_1_1_script.html#a67c2e733f5d2bd4ecfccd69b9cae7721">  374</a></span><span class="keywordtype">bool</span> <a class="code hl_function" href="class_k_win_1_1_script.html#a67c2e733f5d2bd4ecfccd69b9cae7721">KWin::Script::registerShortcut</a>(<span class="keyword">const</span> QString &amp;objectName, <span class="keyword">const</span> QString &amp;text, <span class="keyword">const</span> QString &amp;keySequence, <span class="keyword">const</span> QJSValue &amp;callback)</div>
<div class="line"><a id="l00375" name="l00375"></a><span class="lineno">  375</span>{</div>
<div class="line"><a id="l00376" name="l00376"></a><span class="lineno">  376</span>    <span class="keywordflow">if</span> (!callback.isCallable()) {</div>
<div class="line"><a id="l00377" name="l00377"></a><span class="lineno">  377</span>        m_engine-&gt;throwError(QStringLiteral(<span class="stringliteral">&quot;Shortcut handler must be callable&quot;</span>));</div>
<div class="line"><a id="l00378" name="l00378"></a><span class="lineno">  378</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00379" name="l00379"></a><span class="lineno">  379</span>    }</div>
<div class="line"><a id="l00380" name="l00380"></a><span class="lineno">  380</span> </div>
<div class="line"><a id="l00381" name="l00381"></a><span class="lineno">  381</span>    QAction *action = <span class="keyword">new</span> QAction(<span class="keyword">this</span>);</div>
<div class="line"><a id="l00382" name="l00382"></a><span class="lineno">  382</span>    action-&gt;setObjectName(objectName);</div>
<div class="line"><a id="l00383" name="l00383"></a><span class="lineno">  383</span>    action-&gt;setText(text);</div>
<div class="line"><a id="l00384" name="l00384"></a><span class="lineno">  384</span> </div>
<div class="line"><a id="l00385" name="l00385"></a><span class="lineno">  385</span>    <span class="keyword">const</span> QKeySequence shortcut = keySequence;</div>
<div class="line"><a id="l00386" name="l00386"></a><span class="lineno">  386</span>    KGlobalAccel::self()-&gt;setShortcut(action, {shortcut});</div>
<div class="line"><a id="l00387" name="l00387"></a><span class="lineno">  387</span> </div>
<div class="line"><a id="l00388" name="l00388"></a><span class="lineno">  388</span>    connect(action, &amp;QAction::triggered, <span class="keyword">this</span>, [<span class="keyword">this</span>, action, callback]() {</div>
<div class="line"><a id="l00389" name="l00389"></a><span class="lineno">  389</span>        QJSValue(callback).call({m_engine-&gt;toScriptValue(action)});</div>
<div class="line"><a id="l00390" name="l00390"></a><span class="lineno">  390</span>    });</div>
<div class="line"><a id="l00391" name="l00391"></a><span class="lineno">  391</span> </div>
<div class="line"><a id="l00392" name="l00392"></a><span class="lineno">  392</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00393" name="l00393"></a><span class="lineno">  393</span>}</div>
</div>
<div class="line"><a id="l00394" name="l00394"></a><span class="lineno">  394</span> </div>
<div class="foldopen" id="foldopen00395" data-start="{" data-end="}">
<div class="line"><a id="l00395" name="l00395"></a><span class="lineno"><a class="line" href="class_k_win_1_1_script.html#aec2f16a1931cb76ae63800317f59143f">  395</a></span><span class="keywordtype">bool</span> <a class="code hl_function" href="class_k_win_1_1_script.html#aec2f16a1931cb76ae63800317f59143f">KWin::Script::registerScreenEdge</a>(<span class="keywordtype">int</span> edge, <span class="keyword">const</span> QJSValue &amp;callback)</div>
<div class="line"><a id="l00396" name="l00396"></a><span class="lineno">  396</span>{</div>
<div class="line"><a id="l00397" name="l00397"></a><span class="lineno">  397</span>    <span class="keywordflow">if</span> (!callback.isCallable()) {</div>
<div class="line"><a id="l00398" name="l00398"></a><span class="lineno">  398</span>        m_engine-&gt;throwError(QStringLiteral(<span class="stringliteral">&quot;Screen edge handler must be callable&quot;</span>));</div>
<div class="line"><a id="l00399" name="l00399"></a><span class="lineno">  399</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00400" name="l00400"></a><span class="lineno">  400</span>    }</div>
<div class="line"><a id="l00401" name="l00401"></a><span class="lineno">  401</span> </div>
<div class="line"><a id="l00402" name="l00402"></a><span class="lineno">  402</span>    QJSValueList &amp;callbacks = m_screenEdgeCallbacks[edge];</div>
<div class="line"><a id="l00403" name="l00403"></a><span class="lineno">  403</span>    <span class="keywordflow">if</span> (callbacks.isEmpty()) {</div>
<div class="line"><a id="l00404" name="l00404"></a><span class="lineno">  404</span>        <a class="code hl_function" href="namespace_k_win.html#a8700e164bd811b5f862b944a87bb9b85">workspace</a>()-&gt;<a class="code hl_function" href="class_k_win_1_1_workspace.html#a21cf494fbdd48523724bd6f35bf5547e">screenEdges</a>()-&gt;<a class="code hl_function" href="class_k_win_1_1_screen_edges.html#a26e8b8046e90de4811253d87de67477d">reserve</a>(<span class="keyword">static_cast&lt;</span><a class="code hl_enumeration" href="namespace_k_win.html#a7eda12963fb07e3df0c1f337e8526bc5">KWin::ElectricBorder</a><span class="keyword">&gt;</span>(edge), <span class="keyword">this</span>, <span class="stringliteral">&quot;slotBorderActivated&quot;</span>);</div>
<div class="line"><a id="l00405" name="l00405"></a><span class="lineno">  405</span>    }</div>
<div class="line"><a id="l00406" name="l00406"></a><span class="lineno">  406</span> </div>
<div class="line"><a id="l00407" name="l00407"></a><span class="lineno">  407</span>    callbacks &lt;&lt; callback;</div>
<div class="line"><a id="l00408" name="l00408"></a><span class="lineno">  408</span> </div>
<div class="line"><a id="l00409" name="l00409"></a><span class="lineno">  409</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00410" name="l00410"></a><span class="lineno">  410</span>}</div>
</div>
<div class="line"><a id="l00411" name="l00411"></a><span class="lineno">  411</span> </div>
<div class="foldopen" id="foldopen00412" data-start="{" data-end="}">
<div class="line"><a id="l00412" name="l00412"></a><span class="lineno"><a class="line" href="class_k_win_1_1_script.html#ad1d31827251be0938d99afeb9c75fb15">  412</a></span><span class="keywordtype">bool</span> <a class="code hl_function" href="class_k_win_1_1_script.html#ad1d31827251be0938d99afeb9c75fb15">KWin::Script::unregisterScreenEdge</a>(<span class="keywordtype">int</span> edge)</div>
<div class="line"><a id="l00413" name="l00413"></a><span class="lineno">  413</span>{</div>
<div class="line"><a id="l00414" name="l00414"></a><span class="lineno">  414</span>    <span class="keyword">auto</span> it = m_screenEdgeCallbacks.find(edge);</div>
<div class="line"><a id="l00415" name="l00415"></a><span class="lineno">  415</span>    <span class="keywordflow">if</span> (it == m_screenEdgeCallbacks.end()) {</div>
<div class="line"><a id="l00416" name="l00416"></a><span class="lineno">  416</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00417" name="l00417"></a><span class="lineno">  417</span>    }</div>
<div class="line"><a id="l00418" name="l00418"></a><span class="lineno">  418</span> </div>
<div class="line"><a id="l00419" name="l00419"></a><span class="lineno">  419</span>    <a class="code hl_function" href="namespace_k_win.html#a8700e164bd811b5f862b944a87bb9b85">workspace</a>()-&gt;<a class="code hl_function" href="class_k_win_1_1_workspace.html#a21cf494fbdd48523724bd6f35bf5547e">screenEdges</a>()-&gt;<a class="code hl_function" href="class_k_win_1_1_screen_edges.html#aaee4026fa795568ea3217b1d70cd4234">unreserve</a>(<span class="keyword">static_cast&lt;</span><a class="code hl_enumeration" href="namespace_k_win.html#a7eda12963fb07e3df0c1f337e8526bc5">KWin::ElectricBorder</a><span class="keyword">&gt;</span>(edge), <span class="keyword">this</span>);</div>
<div class="line"><a id="l00420" name="l00420"></a><span class="lineno">  420</span>    m_screenEdgeCallbacks.erase(it);</div>
<div class="line"><a id="l00421" name="l00421"></a><span class="lineno">  421</span> </div>
<div class="line"><a id="l00422" name="l00422"></a><span class="lineno">  422</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00423" name="l00423"></a><span class="lineno">  423</span>}</div>
</div>
<div class="line"><a id="l00424" name="l00424"></a><span class="lineno">  424</span> </div>
<div class="foldopen" id="foldopen00425" data-start="{" data-end="}">
<div class="line"><a id="l00425" name="l00425"></a><span class="lineno"><a class="line" href="class_k_win_1_1_script.html#a5c248700c9be5f45686920811c53f397">  425</a></span><span class="keywordtype">bool</span> <a class="code hl_function" href="class_k_win_1_1_script.html#a5c248700c9be5f45686920811c53f397">KWin::Script::registerTouchScreenEdge</a>(<span class="keywordtype">int</span> edge, <span class="keyword">const</span> QJSValue &amp;callback)</div>
<div class="line"><a id="l00426" name="l00426"></a><span class="lineno">  426</span>{</div>
<div class="line"><a id="l00427" name="l00427"></a><span class="lineno">  427</span>    <span class="keywordflow">if</span> (!callback.isCallable()) {</div>
<div class="line"><a id="l00428" name="l00428"></a><span class="lineno">  428</span>        m_engine-&gt;throwError(QStringLiteral(<span class="stringliteral">&quot;Touch screen edge handler must be callable&quot;</span>));</div>
<div class="line"><a id="l00429" name="l00429"></a><span class="lineno">  429</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00430" name="l00430"></a><span class="lineno">  430</span>    }</div>
<div class="line"><a id="l00431" name="l00431"></a><span class="lineno">  431</span>    <span class="keywordflow">if</span> (m_touchScreenEdgeCallbacks.contains(edge)) {</div>
<div class="line"><a id="l00432" name="l00432"></a><span class="lineno">  432</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00433" name="l00433"></a><span class="lineno">  433</span>    }</div>
<div class="line"><a id="l00434" name="l00434"></a><span class="lineno">  434</span> </div>
<div class="line"><a id="l00435" name="l00435"></a><span class="lineno">  435</span>    QAction *action = <span class="keyword">new</span> QAction(<span class="keyword">this</span>);</div>
<div class="line"><a id="l00436" name="l00436"></a><span class="lineno">  436</span>    <a class="code hl_function" href="namespace_k_win.html#a8700e164bd811b5f862b944a87bb9b85">workspace</a>()-&gt;<a class="code hl_function" href="class_k_win_1_1_workspace.html#a21cf494fbdd48523724bd6f35bf5547e">screenEdges</a>()-&gt;<a class="code hl_function" href="class_k_win_1_1_screen_edges.html#abdd24d5b332b226ad4b3b84d79979721">reserveTouch</a>(<a class="code hl_enumeration" href="namespace_k_win.html#a7eda12963fb07e3df0c1f337e8526bc5">KWin::ElectricBorder</a>(edge), action);</div>
<div class="line"><a id="l00437" name="l00437"></a><span class="lineno">  437</span>    m_touchScreenEdgeCallbacks.insert(edge, action);</div>
<div class="line"><a id="l00438" name="l00438"></a><span class="lineno">  438</span> </div>
<div class="line"><a id="l00439" name="l00439"></a><span class="lineno">  439</span>    connect(action, &amp;QAction::triggered, <span class="keyword">this</span>, [callback]() {</div>
<div class="line"><a id="l00440" name="l00440"></a><span class="lineno">  440</span>        QJSValue(callback).call();</div>
<div class="line"><a id="l00441" name="l00441"></a><span class="lineno">  441</span>    });</div>
<div class="line"><a id="l00442" name="l00442"></a><span class="lineno">  442</span> </div>
<div class="line"><a id="l00443" name="l00443"></a><span class="lineno">  443</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00444" name="l00444"></a><span class="lineno">  444</span>}</div>
</div>
<div class="line"><a id="l00445" name="l00445"></a><span class="lineno">  445</span> </div>
<div class="foldopen" id="foldopen00446" data-start="{" data-end="}">
<div class="line"><a id="l00446" name="l00446"></a><span class="lineno"><a class="line" href="class_k_win_1_1_script.html#a3c166d77163bd5f8f1212aa2b0b9c103">  446</a></span><span class="keywordtype">bool</span> <a class="code hl_function" href="class_k_win_1_1_script.html#a3c166d77163bd5f8f1212aa2b0b9c103">KWin::Script::unregisterTouchScreenEdge</a>(<span class="keywordtype">int</span> edge)</div>
<div class="line"><a id="l00447" name="l00447"></a><span class="lineno">  447</span>{</div>
<div class="line"><a id="l00448" name="l00448"></a><span class="lineno">  448</span>    <span class="keyword">auto</span> it = m_touchScreenEdgeCallbacks.find(edge);</div>
<div class="line"><a id="l00449" name="l00449"></a><span class="lineno">  449</span>    <span class="keywordflow">if</span> (it == m_touchScreenEdgeCallbacks.end()) {</div>
<div class="line"><a id="l00450" name="l00450"></a><span class="lineno">  450</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00451" name="l00451"></a><span class="lineno">  451</span>    }</div>
<div class="line"><a id="l00452" name="l00452"></a><span class="lineno">  452</span> </div>
<div class="line"><a id="l00453" name="l00453"></a><span class="lineno">  453</span>    <span class="keyword">delete</span> it.value();</div>
<div class="line"><a id="l00454" name="l00454"></a><span class="lineno">  454</span>    m_touchScreenEdgeCallbacks.erase(it);</div>
<div class="line"><a id="l00455" name="l00455"></a><span class="lineno">  455</span> </div>
<div class="line"><a id="l00456" name="l00456"></a><span class="lineno">  456</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00457" name="l00457"></a><span class="lineno">  457</span>}</div>
</div>
<div class="line"><a id="l00458" name="l00458"></a><span class="lineno">  458</span> </div>
<div class="foldopen" id="foldopen00459" data-start="{" data-end="}">
<div class="line"><a id="l00459" name="l00459"></a><span class="lineno"><a class="line" href="class_k_win_1_1_script.html#abf13a1ea2aa7473b508aded77caa8c2b">  459</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="class_k_win_1_1_script.html#abf13a1ea2aa7473b508aded77caa8c2b">KWin::Script::registerUserActionsMenu</a>(<span class="keyword">const</span> QJSValue &amp;callback)</div>
<div class="line"><a id="l00460" name="l00460"></a><span class="lineno">  460</span>{</div>
<div class="line"><a id="l00461" name="l00461"></a><span class="lineno">  461</span>    <span class="keywordflow">if</span> (!callback.isCallable()) {</div>
<div class="line"><a id="l00462" name="l00462"></a><span class="lineno">  462</span>        m_engine-&gt;throwError(QStringLiteral(<span class="stringliteral">&quot;User action handler must be callable&quot;</span>));</div>
<div class="line"><a id="l00463" name="l00463"></a><span class="lineno">  463</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00464" name="l00464"></a><span class="lineno">  464</span>    }</div>
<div class="line"><a id="l00465" name="l00465"></a><span class="lineno">  465</span>    m_userActionsMenuCallbacks.append(callback);</div>
<div class="line"><a id="l00466" name="l00466"></a><span class="lineno">  466</span>}</div>
</div>
<div class="line"><a id="l00467" name="l00467"></a><span class="lineno">  467</span> </div>
<div class="foldopen" id="foldopen00468" data-start="{" data-end="}">
<div class="line"><a id="l00468" name="l00468"></a><span class="lineno"><a class="line" href="class_k_win_1_1_script.html#a71b2899512833c0f332ceb2e2dbd7087">  468</a></span>QList&lt;QAction *&gt; <a class="code hl_function" href="class_k_win_1_1_script.html#a71b2899512833c0f332ceb2e2dbd7087">KWin::Script::actionsForUserActionMenu</a>(<a class="code hl_class" href="class_k_win_1_1_window.html">KWin::Window</a> *client, QMenu *parent)</div>
<div class="line"><a id="l00469" name="l00469"></a><span class="lineno">  469</span>{</div>
<div class="line"><a id="l00470" name="l00470"></a><span class="lineno">  470</span>    QList&lt;QAction *&gt; actions;</div>
<div class="line"><a id="l00471" name="l00471"></a><span class="lineno">  471</span>    actions.reserve(m_userActionsMenuCallbacks.count());</div>
<div class="line"><a id="l00472" name="l00472"></a><span class="lineno">  472</span> </div>
<div class="line"><a id="l00473" name="l00473"></a><span class="lineno">  473</span>    <span class="keywordflow">for</span> (QJSValue callback : std::as_const(m_userActionsMenuCallbacks)) {</div>
<div class="line"><a id="l00474" name="l00474"></a><span class="lineno">  474</span>        <span class="keyword">const</span> QJSValue result = callback.call({m_engine-&gt;toScriptValue(client)});</div>
<div class="line"><a id="l00475" name="l00475"></a><span class="lineno">  475</span>        <span class="keywordflow">if</span> (result.isError()) {</div>
<div class="line"><a id="l00476" name="l00476"></a><span class="lineno">  476</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00477" name="l00477"></a><span class="lineno">  477</span>        }</div>
<div class="line"><a id="l00478" name="l00478"></a><span class="lineno">  478</span>        <span class="keywordflow">if</span> (!result.isObject()) {</div>
<div class="line"><a id="l00479" name="l00479"></a><span class="lineno">  479</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00480" name="l00480"></a><span class="lineno">  480</span>        }</div>
<div class="line"><a id="l00481" name="l00481"></a><span class="lineno">  481</span>        <span class="keywordflow">if</span> (QAction *action = scriptValueToAction(result, parent)) {</div>
<div class="line"><a id="l00482" name="l00482"></a><span class="lineno">  482</span>            actions &lt;&lt; action;</div>
<div class="line"><a id="l00483" name="l00483"></a><span class="lineno">  483</span>        }</div>
<div class="line"><a id="l00484" name="l00484"></a><span class="lineno">  484</span>    }</div>
<div class="line"><a id="l00485" name="l00485"></a><span class="lineno">  485</span> </div>
<div class="line"><a id="l00486" name="l00486"></a><span class="lineno">  486</span>    <span class="keywordflow">return</span> actions;</div>
<div class="line"><a id="l00487" name="l00487"></a><span class="lineno">  487</span>}</div>
</div>
<div class="line"><a id="l00488" name="l00488"></a><span class="lineno">  488</span> </div>
<div class="line"><a id="l00489" name="l00489"></a><span class="lineno">  489</span><span class="keywordtype">bool</span> KWin::Script::slotBorderActivated(<a class="code hl_enumeration" href="namespace_k_win.html#a7eda12963fb07e3df0c1f337e8526bc5">ElectricBorder</a> border)</div>
<div class="line"><a id="l00490" name="l00490"></a><span class="lineno">  490</span>{</div>
<div class="line"><a id="l00491" name="l00491"></a><span class="lineno">  491</span>    <span class="keyword">const</span> QJSValueList callbacks = m_screenEdgeCallbacks.value(border);</div>
<div class="line"><a id="l00492" name="l00492"></a><span class="lineno">  492</span>    <span class="keywordflow">if</span> (callbacks.isEmpty()) {</div>
<div class="line"><a id="l00493" name="l00493"></a><span class="lineno">  493</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00494" name="l00494"></a><span class="lineno">  494</span>    }</div>
<div class="line"><a id="l00495" name="l00495"></a><span class="lineno">  495</span>    std::for_each(callbacks.begin(), callbacks.end(), [](QJSValue callback) {</div>
<div class="line"><a id="l00496" name="l00496"></a><span class="lineno">  496</span>        callback.call();</div>
<div class="line"><a id="l00497" name="l00497"></a><span class="lineno">  497</span>    });</div>
<div class="line"><a id="l00498" name="l00498"></a><span class="lineno">  498</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00499" name="l00499"></a><span class="lineno">  499</span>}</div>
<div class="line"><a id="l00500" name="l00500"></a><span class="lineno">  500</span> </div>
<div class="line"><a id="l00501" name="l00501"></a><span class="lineno">  501</span>QAction *KWin::Script::scriptValueToAction(<span class="keyword">const</span> QJSValue &amp;value, QMenu *parent)</div>
<div class="line"><a id="l00502" name="l00502"></a><span class="lineno">  502</span>{</div>
<div class="line"><a id="l00503" name="l00503"></a><span class="lineno">  503</span>    <span class="keyword">const</span> QString title = value.property(QStringLiteral(<span class="stringliteral">&quot;text&quot;</span>)).toString();</div>
<div class="line"><a id="l00504" name="l00504"></a><span class="lineno">  504</span>    <span class="keywordflow">if</span> (title.isEmpty()) {</div>
<div class="line"><a id="l00505" name="l00505"></a><span class="lineno">  505</span>        <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00506" name="l00506"></a><span class="lineno">  506</span>    }</div>
<div class="line"><a id="l00507" name="l00507"></a><span class="lineno">  507</span> </div>
<div class="line"><a id="l00508" name="l00508"></a><span class="lineno">  508</span>    <span class="comment">// Either a menu or a menu item.</span></div>
<div class="line"><a id="l00509" name="l00509"></a><span class="lineno">  509</span>    <span class="keyword">const</span> QJSValue itemsValue = value.property(QStringLiteral(<span class="stringliteral">&quot;items&quot;</span>));</div>
<div class="line"><a id="l00510" name="l00510"></a><span class="lineno">  510</span>    <span class="keywordflow">if</span> (!itemsValue.isUndefined()) {</div>
<div class="line"><a id="l00511" name="l00511"></a><span class="lineno">  511</span>        <span class="keywordflow">return</span> createMenu(title, itemsValue, parent);</div>
<div class="line"><a id="l00512" name="l00512"></a><span class="lineno">  512</span>    }</div>
<div class="line"><a id="l00513" name="l00513"></a><span class="lineno">  513</span> </div>
<div class="line"><a id="l00514" name="l00514"></a><span class="lineno">  514</span>    <span class="keywordflow">return</span> createAction(title, value, parent);</div>
<div class="line"><a id="l00515" name="l00515"></a><span class="lineno">  515</span>}</div>
<div class="line"><a id="l00516" name="l00516"></a><span class="lineno">  516</span> </div>
<div class="line"><a id="l00517" name="l00517"></a><span class="lineno">  517</span>QAction *KWin::Script::createAction(<span class="keyword">const</span> QString &amp;title, <span class="keyword">const</span> QJSValue &amp;item, QMenu *parent)</div>
<div class="line"><a id="l00518" name="l00518"></a><span class="lineno">  518</span>{</div>
<div class="line"><a id="l00519" name="l00519"></a><span class="lineno">  519</span>    <span class="keyword">const</span> QJSValue callback = item.property(QStringLiteral(<span class="stringliteral">&quot;triggered&quot;</span>));</div>
<div class="line"><a id="l00520" name="l00520"></a><span class="lineno">  520</span>    <span class="keywordflow">if</span> (!callback.isCallable()) {</div>
<div class="line"><a id="l00521" name="l00521"></a><span class="lineno">  521</span>        <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00522" name="l00522"></a><span class="lineno">  522</span>    }</div>
<div class="line"><a id="l00523" name="l00523"></a><span class="lineno">  523</span> </div>
<div class="line"><a id="l00524" name="l00524"></a><span class="lineno">  524</span>    <span class="keyword">const</span> <span class="keywordtype">bool</span> checkable = item.property(QStringLiteral(<span class="stringliteral">&quot;checkable&quot;</span>)).toBool();</div>
<div class="line"><a id="l00525" name="l00525"></a><span class="lineno">  525</span>    <span class="keyword">const</span> <span class="keywordtype">bool</span> checked = item.property(QStringLiteral(<span class="stringliteral">&quot;checked&quot;</span>)).toBool();</div>
<div class="line"><a id="l00526" name="l00526"></a><span class="lineno">  526</span> </div>
<div class="line"><a id="l00527" name="l00527"></a><span class="lineno">  527</span>    QAction *action = <span class="keyword">new</span> QAction(title, parent);</div>
<div class="line"><a id="l00528" name="l00528"></a><span class="lineno">  528</span>    action-&gt;setCheckable(checkable);</div>
<div class="line"><a id="l00529" name="l00529"></a><span class="lineno">  529</span>    action-&gt;setChecked(checked);</div>
<div class="line"><a id="l00530" name="l00530"></a><span class="lineno">  530</span> </div>
<div class="line"><a id="l00531" name="l00531"></a><span class="lineno">  531</span>    connect(action, &amp;QAction::triggered, <span class="keyword">this</span>, [<span class="keyword">this</span>, action, callback]() {</div>
<div class="line"><a id="l00532" name="l00532"></a><span class="lineno">  532</span>        QJSValue(callback).call({m_engine-&gt;toScriptValue(action)});</div>
<div class="line"><a id="l00533" name="l00533"></a><span class="lineno">  533</span>    });</div>
<div class="line"><a id="l00534" name="l00534"></a><span class="lineno">  534</span> </div>
<div class="line"><a id="l00535" name="l00535"></a><span class="lineno">  535</span>    <span class="keywordflow">return</span> action;</div>
<div class="line"><a id="l00536" name="l00536"></a><span class="lineno">  536</span>}</div>
<div class="line"><a id="l00537" name="l00537"></a><span class="lineno">  537</span> </div>
<div class="line"><a id="l00538" name="l00538"></a><span class="lineno">  538</span>QAction *KWin::Script::createMenu(<span class="keyword">const</span> QString &amp;title, <span class="keyword">const</span> QJSValue &amp;items, QMenu *parent)</div>
<div class="line"><a id="l00539" name="l00539"></a><span class="lineno">  539</span>{</div>
<div class="line"><a id="l00540" name="l00540"></a><span class="lineno">  540</span>    <span class="keywordflow">if</span> (!items.isArray()) {</div>
<div class="line"><a id="l00541" name="l00541"></a><span class="lineno">  541</span>        <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00542" name="l00542"></a><span class="lineno">  542</span>    }</div>
<div class="line"><a id="l00543" name="l00543"></a><span class="lineno">  543</span> </div>
<div class="line"><a id="l00544" name="l00544"></a><span class="lineno">  544</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> length = items.property(QStringLiteral(<span class="stringliteral">&quot;length&quot;</span>)).toInt();</div>
<div class="line"><a id="l00545" name="l00545"></a><span class="lineno">  545</span>    <span class="keywordflow">if</span> (!length) {</div>
<div class="line"><a id="l00546" name="l00546"></a><span class="lineno">  546</span>        <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00547" name="l00547"></a><span class="lineno">  547</span>    }</div>
<div class="line"><a id="l00548" name="l00548"></a><span class="lineno">  548</span> </div>
<div class="line"><a id="l00549" name="l00549"></a><span class="lineno">  549</span>    QMenu *menu = <span class="keyword">new</span> QMenu(title, parent);</div>
<div class="line"><a id="l00550" name="l00550"></a><span class="lineno">  550</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; length; ++i) {</div>
<div class="line"><a id="l00551" name="l00551"></a><span class="lineno">  551</span>        <span class="keyword">const</span> QJSValue value = items.property(QString::number(i));</div>
<div class="line"><a id="l00552" name="l00552"></a><span class="lineno">  552</span>        <span class="keywordflow">if</span> (!value.isObject()) {</div>
<div class="line"><a id="l00553" name="l00553"></a><span class="lineno">  553</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00554" name="l00554"></a><span class="lineno">  554</span>        }</div>
<div class="line"><a id="l00555" name="l00555"></a><span class="lineno">  555</span>        <span class="keywordflow">if</span> (QAction *action = scriptValueToAction(value, menu)) {</div>
<div class="line"><a id="l00556" name="l00556"></a><span class="lineno">  556</span>            menu-&gt;addAction(action);</div>
<div class="line"><a id="l00557" name="l00557"></a><span class="lineno">  557</span>        }</div>
<div class="line"><a id="l00558" name="l00558"></a><span class="lineno">  558</span>    }</div>
<div class="line"><a id="l00559" name="l00559"></a><span class="lineno">  559</span> </div>
<div class="line"><a id="l00560" name="l00560"></a><span class="lineno">  560</span>    <span class="keywordflow">return</span> menu-&gt;menuAction();</div>
<div class="line"><a id="l00561" name="l00561"></a><span class="lineno">  561</span>}</div>
<div class="line"><a id="l00562" name="l00562"></a><span class="lineno">  562</span> </div>
<div class="foldopen" id="foldopen00563" data-start="{" data-end="}">
<div class="line"><a id="l00563" name="l00563"></a><span class="lineno"><a class="line" href="class_k_win_1_1_declarative_script.html#ad4aaeff1be15700c211a59639370080a">  563</a></span><a class="code hl_function" href="class_k_win_1_1_declarative_script.html#ad4aaeff1be15700c211a59639370080a">KWin::DeclarativeScript::DeclarativeScript</a>(<span class="keywordtype">int</span> <span class="keywordtype">id</span>, QString scriptName, QString pluginName, QObject *parent)</div>
<div class="line"><a id="l00564" name="l00564"></a><span class="lineno">  564</span>    : <a class="code hl_class" href="class_k_win_1_1_abstract_script.html">AbstractScript</a>(id, scriptName, pluginName, parent)</div>
<div class="line"><a id="l00565" name="l00565"></a><span class="lineno">  565</span>    , m_context(new QQmlContext(<a class="code hl_class" href="class_k_win_1_1_scripting.html">Scripting</a>::self()-&gt;declarativeScriptSharedContext(), this))</div>
<div class="line"><a id="l00566" name="l00566"></a><span class="lineno">  566</span>    , m_component(new QQmlComponent(<a class="code hl_class" href="class_k_win_1_1_scripting.html">Scripting</a>::self()-&gt;qmlEngine(), this))</div>
<div class="line"><a id="l00567" name="l00567"></a><span class="lineno">  567</span>{</div>
<div class="line"><a id="l00568" name="l00568"></a><span class="lineno">  568</span>    m_context-&gt;setContextProperty(QStringLiteral(<span class="stringliteral">&quot;KWin&quot;</span>), <span class="keyword">new</span> <a class="code hl_class" href="class_k_win_1_1_j_s_engine_global_methods_wrapper.html">JSEngineGlobalMethodsWrapper</a>(<span class="keyword">this</span>));</div>
<div class="line"><a id="l00569" name="l00569"></a><span class="lineno">  569</span>}</div>
</div>
<div class="line"><a id="l00570" name="l00570"></a><span class="lineno">  570</span> </div>
<div class="foldopen" id="foldopen00571" data-start="{" data-end="}">
<div class="line"><a id="l00571" name="l00571"></a><span class="lineno"><a class="line" href="class_k_win_1_1_declarative_script.html#a45d299727e1402417c866b50be01f9b3">  571</a></span><a class="code hl_function" href="class_k_win_1_1_declarative_script.html#a45d299727e1402417c866b50be01f9b3">KWin::DeclarativeScript::~DeclarativeScript</a>()</div>
<div class="line"><a id="l00572" name="l00572"></a><span class="lineno">  572</span>{</div>
<div class="line"><a id="l00573" name="l00573"></a><span class="lineno">  573</span>}</div>
</div>
<div class="line"><a id="l00574" name="l00574"></a><span class="lineno">  574</span> </div>
<div class="foldopen" id="foldopen00575" data-start="{" data-end="}">
<div class="line"><a id="l00575" name="l00575"></a><span class="lineno"><a class="line" href="class_k_win_1_1_declarative_script.html#a18b787cd3ad89dd5b3e64c71f15cf1ce">  575</a></span><span class="keywordtype">void</span> <a class="code hl_slot" href="class_k_win_1_1_declarative_script.html#a18b787cd3ad89dd5b3e64c71f15cf1ce">KWin::DeclarativeScript::run</a>()</div>
<div class="line"><a id="l00576" name="l00576"></a><span class="lineno">  576</span>{</div>
<div class="line"><a id="l00577" name="l00577"></a><span class="lineno">  577</span>    <span class="keywordflow">if</span> (running()) {</div>
<div class="line"><a id="l00578" name="l00578"></a><span class="lineno">  578</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00579" name="l00579"></a><span class="lineno">  579</span>    }</div>
<div class="line"><a id="l00580" name="l00580"></a><span class="lineno">  580</span> </div>
<div class="line"><a id="l00581" name="l00581"></a><span class="lineno">  581</span>    m_component-&gt;loadUrl(QUrl::fromLocalFile(fileName()));</div>
<div class="line"><a id="l00582" name="l00582"></a><span class="lineno">  582</span>    <span class="keywordflow">if</span> (m_component-&gt;isLoading()) {</div>
<div class="line"><a id="l00583" name="l00583"></a><span class="lineno">  583</span>        connect(m_component, &amp;QQmlComponent::statusChanged, <span class="keyword">this</span>, &amp;DeclarativeScript::createComponent);</div>
<div class="line"><a id="l00584" name="l00584"></a><span class="lineno">  584</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00585" name="l00585"></a><span class="lineno">  585</span>        createComponent();</div>
<div class="line"><a id="l00586" name="l00586"></a><span class="lineno">  586</span>    }</div>
<div class="line"><a id="l00587" name="l00587"></a><span class="lineno">  587</span>}</div>
</div>
<div class="line"><a id="l00588" name="l00588"></a><span class="lineno">  588</span> </div>
<div class="line"><a id="l00589" name="l00589"></a><span class="lineno">  589</span><span class="keywordtype">void</span> KWin::DeclarativeScript::createComponent()</div>
<div class="line"><a id="l00590" name="l00590"></a><span class="lineno">  590</span>{</div>
<div class="line"><a id="l00591" name="l00591"></a><span class="lineno">  591</span>    <span class="keywordflow">if</span> (m_component-&gt;isError()) {</div>
<div class="line"><a id="l00592" name="l00592"></a><span class="lineno">  592</span>        qCWarning(KWIN_SCRIPTING) &lt;&lt; <span class="stringliteral">&quot;Component failed to load: &quot;</span> &lt;&lt; m_component-&gt;errors();</div>
<div class="line"><a id="l00593" name="l00593"></a><span class="lineno">  593</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00594" name="l00594"></a><span class="lineno">  594</span>        <span class="keywordflow">if</span> (QObject *<span class="keywordtype">object</span> = m_component-&gt;create(m_context)) {</div>
<div class="line"><a id="l00595" name="l00595"></a><span class="lineno">  595</span>            <span class="keywordtype">object</span>-&gt;setParent(<span class="keyword">this</span>);</div>
<div class="line"><a id="l00596" name="l00596"></a><span class="lineno">  596</span>        }</div>
<div class="line"><a id="l00597" name="l00597"></a><span class="lineno">  597</span>    }</div>
<div class="line"><a id="l00598" name="l00598"></a><span class="lineno">  598</span>    setRunning(<span class="keyword">true</span>);</div>
<div class="line"><a id="l00599" name="l00599"></a><span class="lineno">  599</span>}</div>
<div class="line"><a id="l00600" name="l00600"></a><span class="lineno">  600</span> </div>
<div class="foldopen" id="foldopen00601" data-start="{" data-end="}">
<div class="line"><a id="l00601" name="l00601"></a><span class="lineno"><a class="line" href="class_k_win_1_1_j_s_engine_global_methods_wrapper.html#aa7a620aa9f819d9e2429f2acffbf0b80">  601</a></span><a class="code hl_function" href="class_k_win_1_1_j_s_engine_global_methods_wrapper.html#aa7a620aa9f819d9e2429f2acffbf0b80">KWin::JSEngineGlobalMethodsWrapper::JSEngineGlobalMethodsWrapper</a>(<a class="code hl_class" href="class_k_win_1_1_declarative_script.html">KWin::DeclarativeScript</a> *parent)</div>
<div class="line"><a id="l00602" name="l00602"></a><span class="lineno">  602</span>    : QObject(parent)</div>
<div class="line"><a id="l00603" name="l00603"></a><span class="lineno">  603</span>    , m_script(parent)</div>
<div class="line"><a id="l00604" name="l00604"></a><span class="lineno">  604</span>{</div>
<div class="line"><a id="l00605" name="l00605"></a><span class="lineno">  605</span>}</div>
</div>
<div class="line"><a id="l00606" name="l00606"></a><span class="lineno">  606</span> </div>
<div class="foldopen" id="foldopen00607" data-start="{" data-end="}">
<div class="line"><a id="l00607" name="l00607"></a><span class="lineno"><a class="line" href="class_k_win_1_1_j_s_engine_global_methods_wrapper.html#a3afaf6bda1eba512517dff706e9b826b">  607</a></span><a class="code hl_function" href="class_k_win_1_1_j_s_engine_global_methods_wrapper.html#a3afaf6bda1eba512517dff706e9b826b">KWin::JSEngineGlobalMethodsWrapper::~JSEngineGlobalMethodsWrapper</a>()</div>
<div class="line"><a id="l00608" name="l00608"></a><span class="lineno">  608</span>{</div>
<div class="line"><a id="l00609" name="l00609"></a><span class="lineno">  609</span>}</div>
</div>
<div class="line"><a id="l00610" name="l00610"></a><span class="lineno">  610</span> </div>
<div class="foldopen" id="foldopen00611" data-start="{" data-end="}">
<div class="line"><a id="l00611" name="l00611"></a><span class="lineno"><a class="line" href="class_k_win_1_1_j_s_engine_global_methods_wrapper.html#ad1a68caccb57532305c08717beaf36db">  611</a></span>QVariant <a class="code hl_slot" href="class_k_win_1_1_j_s_engine_global_methods_wrapper.html#ad1a68caccb57532305c08717beaf36db">KWin::JSEngineGlobalMethodsWrapper::readConfig</a>(<span class="keyword">const</span> QString &amp;key, QVariant defaultValue)</div>
<div class="line"><a id="l00612" name="l00612"></a><span class="lineno">  612</span>{</div>
<div class="line"><a id="l00613" name="l00613"></a><span class="lineno">  613</span>    <span class="keywordflow">return</span> m_script-&gt;config().readEntry(key, defaultValue);</div>
<div class="line"><a id="l00614" name="l00614"></a><span class="lineno">  614</span>}</div>
</div>
<div class="line"><a id="l00615" name="l00615"></a><span class="lineno">  615</span> </div>
<div class="line"><a id="l00616" name="l00616"></a><span class="lineno">  616</span><a class="code hl_class" href="class_k_win_1_1_scripting.html">KWin::Scripting</a> *KWin::Scripting::s_self = <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00617" name="l00617"></a><span class="lineno">  617</span> </div>
<div class="foldopen" id="foldopen00618" data-start="{" data-end="}">
<div class="line"><a id="l00618" name="l00618"></a><span class="lineno"><a class="line" href="class_k_win_1_1_scripting.html#a435da48783defd7960eaf079e772459a">  618</a></span><a class="code hl_class" href="class_k_win_1_1_scripting.html">KWin::Scripting</a> *<a class="code hl_function" href="class_k_win_1_1_scripting.html#a435da48783defd7960eaf079e772459a">KWin::Scripting::create</a>(QObject *parent)</div>
<div class="line"><a id="l00619" name="l00619"></a><span class="lineno">  619</span>{</div>
<div class="line"><a id="l00620" name="l00620"></a><span class="lineno">  620</span>    Q_ASSERT(!s_self);</div>
<div class="line"><a id="l00621" name="l00621"></a><span class="lineno">  621</span>    s_self = <span class="keyword">new</span> <a class="code hl_class" href="class_k_win_1_1_scripting.html">Scripting</a>(parent);</div>
<div class="line"><a id="l00622" name="l00622"></a><span class="lineno">  622</span>    <span class="keywordflow">return</span> s_self;</div>
<div class="line"><a id="l00623" name="l00623"></a><span class="lineno">  623</span>}</div>
</div>
<div class="line"><a id="l00624" name="l00624"></a><span class="lineno">  624</span> </div>
<div class="line"><a id="l00625" name="l00625"></a><span class="lineno">  625</span>KWin::Scripting::Scripting(QObject *parent)</div>
<div class="line"><a id="l00626" name="l00626"></a><span class="lineno">  626</span>    : QObject(parent)</div>
<div class="line"><a id="l00627" name="l00627"></a><span class="lineno">  627</span>    , m_scriptsLock(new QRecursiveMutex)</div>
<div class="line"><a id="l00628" name="l00628"></a><span class="lineno">  628</span>    , m_qmlEngine(new QQmlEngine(this))</div>
<div class="line"><a id="l00629" name="l00629"></a><span class="lineno">  629</span>    , m_declarativeScriptSharedContext(new QQmlContext(m_qmlEngine, this))</div>
<div class="line"><a id="l00630" name="l00630"></a><span class="lineno">  630</span>    , m_workspaceWrapper(new <a class="code hl_class" href="class_k_win_1_1_qt_script_workspace_wrapper.html">QtScriptWorkspaceWrapper</a>(this))</div>
<div class="line"><a id="l00631" name="l00631"></a><span class="lineno">  631</span>{</div>
<div class="line"><a id="l00632" name="l00632"></a><span class="lineno">  632</span>    m_qmlEngine-&gt;setProperty(<span class="stringliteral">&quot;_kirigamiTheme&quot;</span>, QStringLiteral(<span class="stringliteral">&quot;KirigamiPlasmaStyle&quot;</span>));</div>
<div class="line"><a id="l00633" name="l00633"></a><span class="lineno">  633</span>    m_qmlEngine-&gt;rootContext()-&gt;setContextObject(<span class="keyword">new</span> KLocalizedContext(m_qmlEngine));</div>
<div class="line"><a id="l00634" name="l00634"></a><span class="lineno">  634</span>    init();</div>
<div class="line"><a id="l00635" name="l00635"></a><span class="lineno">  635</span>    QDBusConnection::sessionBus().registerObject(QStringLiteral(<span class="stringliteral">&quot;/Scripting&quot;</span>), <span class="keyword">this</span>, QDBusConnection::ExportScriptableContents | QDBusConnection::ExportScriptableInvokables);</div>
<div class="line"><a id="l00636" name="l00636"></a><span class="lineno">  636</span>    connect(<a class="code hl_function" href="class_k_win_1_1_workspace.html#a8ca8f8a3904f007fd6a256c0d6996201">Workspace::self</a>(), &amp;<a class="code hl_signal" href="class_k_win_1_1_workspace.html#abd94bbc1291ecb4698c459980e158ace">Workspace::configChanged</a>, <span class="keyword">this</span>, &amp;<a class="code hl_slot" href="class_k_win_1_1_scripting.html#afd37e1362c714de166990156ddf62e8a">Scripting::start</a>);</div>
<div class="line"><a id="l00637" name="l00637"></a><span class="lineno">  637</span>    connect(<a class="code hl_function" href="class_k_win_1_1_workspace.html#a8ca8f8a3904f007fd6a256c0d6996201">Workspace::self</a>(), &amp;<a class="code hl_signal" href="class_k_win_1_1_workspace.html#a40a0c2857a176b5288406b0aaa5b79d6">Workspace::workspaceInitialized</a>, <span class="keyword">this</span>, &amp;<a class="code hl_slot" href="class_k_win_1_1_scripting.html#afd37e1362c714de166990156ddf62e8a">Scripting::start</a>);</div>
<div class="line"><a id="l00638" name="l00638"></a><span class="lineno">  638</span>}</div>
<div class="line"><a id="l00639" name="l00639"></a><span class="lineno">  639</span> </div>
<div class="line"><a id="l00640" name="l00640"></a><span class="lineno">  640</span><span class="keywordtype">void</span> KWin::Scripting::init()</div>
<div class="line"><a id="l00641" name="l00641"></a><span class="lineno">  641</span>{</div>
<div class="line"><a id="l00642" name="l00642"></a><span class="lineno">  642</span>    qRegisterMetaType&lt;QList&lt;KWin::Output *&gt;&gt;();</div>
<div class="line"><a id="l00643" name="l00643"></a><span class="lineno">  643</span>    qRegisterMetaType&lt;QList&lt;KWin::Window *&gt;&gt;();</div>
<div class="line"><a id="l00644" name="l00644"></a><span class="lineno">  644</span>    qRegisterMetaType&lt;QList&lt;KWin::VirtualDesktop *&gt;&gt;();</div>
<div class="line"><a id="l00645" name="l00645"></a><span class="lineno">  645</span> </div>
<div class="line"><a id="l00646" name="l00646"></a><span class="lineno">  646</span>    qmlRegisterType&lt;DesktopBackgroundItem&gt;(<span class="stringliteral">&quot;org.kde.kwin&quot;</span>, 3, 0, <span class="stringliteral">&quot;DesktopBackground&quot;</span>);</div>
<div class="line"><a id="l00647" name="l00647"></a><span class="lineno">  647</span>    qmlRegisterType&lt;WindowThumbnailItem&gt;(<span class="stringliteral">&quot;org.kde.kwin&quot;</span>, 3, 0, <span class="stringliteral">&quot;WindowThumbnail&quot;</span>);</div>
<div class="line"><a id="l00648" name="l00648"></a><span class="lineno">  648</span>    qmlRegisterType&lt;DBusCall&gt;(<span class="stringliteral">&quot;org.kde.kwin&quot;</span>, 3, 0, <span class="stringliteral">&quot;DBusCall&quot;</span>);</div>
<div class="line"><a id="l00649" name="l00649"></a><span class="lineno">  649</span>    qmlRegisterType&lt;ScreenEdgeHandler&gt;(<span class="stringliteral">&quot;org.kde.kwin&quot;</span>, 3, 0, <span class="stringliteral">&quot;ScreenEdgeHandler&quot;</span>);</div>
<div class="line"><a id="l00650" name="l00650"></a><span class="lineno">  650</span>    qmlRegisterType&lt;ShortcutHandler&gt;(<span class="stringliteral">&quot;org.kde.kwin&quot;</span>, 3, 0, <span class="stringliteral">&quot;ShortcutHandler&quot;</span>);</div>
<div class="line"><a id="l00651" name="l00651"></a><span class="lineno">  651</span>    qmlRegisterType&lt;SwipeGestureHandler&gt;(<span class="stringliteral">&quot;org.kde.kwin&quot;</span>, 3, 0, <span class="stringliteral">&quot;SwipeGestureHandler&quot;</span>);</div>
<div class="line"><a id="l00652" name="l00652"></a><span class="lineno">  652</span>    qmlRegisterType&lt;PinchGestureHandler&gt;(<span class="stringliteral">&quot;org.kde.kwin&quot;</span>, 3, 0, <span class="stringliteral">&quot;PinchGestureHandler&quot;</span>);</div>
<div class="line"><a id="l00653" name="l00653"></a><span class="lineno">  653</span>    qmlRegisterType&lt;WindowModel&gt;(<span class="stringliteral">&quot;org.kde.kwin&quot;</span>, 3, 0, <span class="stringliteral">&quot;WindowModel&quot;</span>);</div>
<div class="line"><a id="l00654" name="l00654"></a><span class="lineno">  654</span>    qmlRegisterType&lt;WindowFilterModel&gt;(<span class="stringliteral">&quot;org.kde.kwin&quot;</span>, 3, 0, <span class="stringliteral">&quot;WindowFilterModel&quot;</span>);</div>
<div class="line"><a id="l00655" name="l00655"></a><span class="lineno">  655</span>    qmlRegisterType&lt;VirtualDesktopModel&gt;(<span class="stringliteral">&quot;org.kde.kwin&quot;</span>, 3, 0, <span class="stringliteral">&quot;VirtualDesktopModel&quot;</span>);</div>
<div class="line"><a id="l00656" name="l00656"></a><span class="lineno">  656</span>    qmlRegisterUncreatableType&lt;KWin::QuickSceneView&gt;(<span class="stringliteral">&quot;org.kde.kwin&quot;</span>, 3, 0, <span class="stringliteral">&quot;SceneView&quot;</span>, QStringLiteral(<span class="stringliteral">&quot;Can&#39;t instantiate an object of type SceneView&quot;</span>));</div>
<div class="line"><a id="l00657" name="l00657"></a><span class="lineno">  657</span>    qmlRegisterType&lt;ScriptedQuickSceneEffect&gt;(<span class="stringliteral">&quot;org.kde.kwin&quot;</span>, 3, 0, <span class="stringliteral">&quot;SceneEffect&quot;</span>);</div>
<div class="line"><a id="l00658" name="l00658"></a><span class="lineno">  658</span> </div>
<div class="line"><a id="l00659" name="l00659"></a><span class="lineno">  659</span>    qmlRegisterSingletonType&lt;DeclarativeScriptWorkspaceWrapper&gt;(<span class="stringliteral">&quot;org.kde.kwin&quot;</span>, 3, 0, <span class="stringliteral">&quot;Workspace&quot;</span>, [](QQmlEngine *qmlEngine, QJSEngine *jsEngine) {</div>
<div class="line"><a id="l00660" name="l00660"></a><span class="lineno">  660</span>        <span class="keywordflow">return</span> <span class="keyword">new</span> DeclarativeScriptWorkspaceWrapper();</div>
<div class="line"><a id="l00661" name="l00661"></a><span class="lineno">  661</span>    });</div>
<div class="line"><a id="l00662" name="l00662"></a><span class="lineno">  662</span>    qmlRegisterSingletonInstance(<span class="stringliteral">&quot;org.kde.kwin&quot;</span>, 3, 0, <span class="stringliteral">&quot;Options&quot;</span>, <a class="code hl_variable" href="namespace_k_win.html#aacddce7916a99bb943d9071c40754c1c">options</a>);</div>
<div class="line"><a id="l00663" name="l00663"></a><span class="lineno">  663</span> </div>
<div class="line"><a id="l00664" name="l00664"></a><span class="lineno">  664</span>    qmlRegisterAnonymousType&lt;KConfigPropertyMap&gt;(<span class="stringliteral">&quot;org.kde.kwin&quot;</span>, 3);</div>
<div class="line"><a id="l00665" name="l00665"></a><span class="lineno">  665</span>    qmlRegisterAnonymousType&lt;KWin::Output&gt;(<span class="stringliteral">&quot;org.kde.kwin&quot;</span>, 3);</div>
<div class="line"><a id="l00666" name="l00666"></a><span class="lineno">  666</span>    qmlRegisterAnonymousType&lt;KWin::Window&gt;(<span class="stringliteral">&quot;org.kde.kwin&quot;</span>, 3);</div>
<div class="line"><a id="l00667" name="l00667"></a><span class="lineno">  667</span>    qmlRegisterAnonymousType&lt;KWin::VirtualDesktop&gt;(<span class="stringliteral">&quot;org.kde.kwin&quot;</span>, 3);</div>
<div class="line"><a id="l00668" name="l00668"></a><span class="lineno">  668</span>    qmlRegisterAnonymousType&lt;QAbstractItemModel&gt;(<span class="stringliteral">&quot;org.kde.kwin&quot;</span>, 3);</div>
<div class="line"><a id="l00669" name="l00669"></a><span class="lineno">  669</span>    qmlRegisterAnonymousType&lt;KWin::TileManager&gt;(<span class="stringliteral">&quot;org.kde.kwin&quot;</span>, 3);</div>
<div class="line"><a id="l00670" name="l00670"></a><span class="lineno">  670</span>    <span class="comment">// TODO: call the qml types as the C++ types?</span></div>
<div class="line"><a id="l00671" name="l00671"></a><span class="lineno">  671</span>    qmlRegisterUncreatableType&lt;KWin::CustomTile&gt;(<span class="stringliteral">&quot;org.kde.kwin&quot;</span>, 3, 0, <span class="stringliteral">&quot;CustomTile&quot;</span>, QStringLiteral(<span class="stringliteral">&quot;Cannot create objects of type Tile&quot;</span>));</div>
<div class="line"><a id="l00672" name="l00672"></a><span class="lineno">  672</span>    qmlRegisterUncreatableType&lt;KWin::Tile&gt;(<span class="stringliteral">&quot;org.kde.kwin&quot;</span>, 3, 0, <span class="stringliteral">&quot;Tile&quot;</span>, QStringLiteral(<span class="stringliteral">&quot;Cannot create objects of type AbstractTile&quot;</span>));</div>
<div class="line"><a id="l00673" name="l00673"></a><span class="lineno">  673</span>}</div>
<div class="line"><a id="l00674" name="l00674"></a><span class="lineno">  674</span> </div>
<div class="foldopen" id="foldopen00675" data-start="{" data-end="}">
<div class="line"><a id="l00675" name="l00675"></a><span class="lineno"><a class="line" href="class_k_win_1_1_scripting.html#afd37e1362c714de166990156ddf62e8a">  675</a></span><span class="keywordtype">void</span> <a class="code hl_slot" href="class_k_win_1_1_scripting.html#afd37e1362c714de166990156ddf62e8a">KWin::Scripting::start</a>()</div>
<div class="line"><a id="l00676" name="l00676"></a><span class="lineno">  676</span>{</div>
<div class="line"><a id="l00677" name="l00677"></a><span class="lineno">  677</span><span class="preprocessor">#if 0</span></div>
<div class="line"><a id="l00678" name="l00678"></a><span class="lineno">  678</span>    <span class="comment">// TODO make this threaded again once KConfigGroup is sufficiently thread safe, bug #305361 and friends</span></div>
<div class="line"><a id="l00679" name="l00679"></a><span class="lineno">  679</span>    <span class="comment">// perform querying for the services in a thread</span></div>
<div class="line"><a id="l00680" name="l00680"></a><span class="lineno">  680</span>    <a class="code hl_class" href="class_q_future_watcher.html">QFutureWatcher&lt;LoadScriptList&gt;</a> *watcher = <span class="keyword">new</span> <a class="code hl_class" href="class_q_future_watcher.html">QFutureWatcher&lt;LoadScriptList&gt;</a>(<span class="keyword">this</span>);</div>
<div class="line"><a id="l00681" name="l00681"></a><span class="lineno">  681</span>    connect(watcher, &amp;<a class="code hl_class" href="class_q_future_watcher.html">QFutureWatcher&lt;LoadScriptList&gt;::finished</a>, <span class="keyword">this</span>, &amp;Scripting::slotScriptsQueried);</div>
<div class="line"><a id="l00682" name="l00682"></a><span class="lineno">  682</span>    watcher-&gt;setFuture(QtConcurrent::run(<span class="keyword">this</span>, &amp;KWin::Scripting::queryScriptsToLoad, pluginStates, offers));</div>
<div class="line"><a id="l00683" name="l00683"></a><span class="lineno">  683</span><span class="preprocessor">#else</span></div>
<div class="line"><a id="l00684" name="l00684"></a><span class="lineno">  684</span>    <a class="code hl_typedef" href="scripting_8h.html#afb5c13d7e637b8983a9e532a0b6dcbfe">LoadScriptList</a> scriptsToLoad = queryScriptsToLoad();</div>
<div class="line"><a id="l00685" name="l00685"></a><span class="lineno">  685</span>    <span class="keywordflow">for</span> (LoadScriptList::const_iterator it = scriptsToLoad.constBegin();</div>
<div class="line"><a id="l00686" name="l00686"></a><span class="lineno">  686</span>         it != scriptsToLoad.constEnd();</div>
<div class="line"><a id="l00687" name="l00687"></a><span class="lineno">  687</span>         ++it) {</div>
<div class="line"><a id="l00688" name="l00688"></a><span class="lineno">  688</span>        <span class="keywordflow">if</span> (it-&gt;first) {</div>
<div class="line"><a id="l00689" name="l00689"></a><span class="lineno">  689</span>            loadScript(it-&gt;second.first, it-&gt;second.second);</div>
<div class="line"><a id="l00690" name="l00690"></a><span class="lineno">  690</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00691" name="l00691"></a><span class="lineno">  691</span>            loadDeclarativeScript(it-&gt;second.first, it-&gt;second.second);</div>
<div class="line"><a id="l00692" name="l00692"></a><span class="lineno">  692</span>        }</div>
<div class="line"><a id="l00693" name="l00693"></a><span class="lineno">  693</span>    }</div>
<div class="line"><a id="l00694" name="l00694"></a><span class="lineno">  694</span> </div>
<div class="line"><a id="l00695" name="l00695"></a><span class="lineno">  695</span>    runScripts();</div>
<div class="line"><a id="l00696" name="l00696"></a><span class="lineno">  696</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00697" name="l00697"></a><span class="lineno">  697</span>}</div>
</div>
<div class="line"><a id="l00698" name="l00698"></a><span class="lineno">  698</span> </div>
<div class="line"><a id="l00699" name="l00699"></a><span class="lineno">  699</span><a class="code hl_typedef" href="scripting_8h.html#afb5c13d7e637b8983a9e532a0b6dcbfe">LoadScriptList</a> KWin::Scripting::queryScriptsToLoad()</div>
<div class="line"><a id="l00700" name="l00700"></a><span class="lineno">  700</span>{</div>
<div class="line"><a id="l00701" name="l00701"></a><span class="lineno">  701</span>    KSharedConfig::Ptr _config = kwinApp()-&gt;config();</div>
<div class="line"><a id="l00702" name="l00702"></a><span class="lineno">  702</span>    <span class="keyword">static</span> <span class="keywordtype">bool</span> s_started = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00703" name="l00703"></a><span class="lineno">  703</span>    <span class="keywordflow">if</span> (s_started) {</div>
<div class="line"><a id="l00704" name="l00704"></a><span class="lineno">  704</span>        _config-&gt;reparseConfiguration();</div>
<div class="line"><a id="l00705" name="l00705"></a><span class="lineno">  705</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00706" name="l00706"></a><span class="lineno">  706</span>        s_started = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00707" name="l00707"></a><span class="lineno">  707</span>    }</div>
<div class="line"><a id="l00708" name="l00708"></a><span class="lineno">  708</span>    QMap&lt;QString, QString&gt; pluginStates = KConfigGroup(_config, QStringLiteral(<span class="stringliteral">&quot;Plugins&quot;</span>)).entryMap();</div>
<div class="line"><a id="l00709" name="l00709"></a><span class="lineno">  709</span>    <span class="keyword">const</span> QString scriptFolder = QStringLiteral(<span class="stringliteral">&quot;kwin/scripts/&quot;</span>);</div>
<div class="line"><a id="l00710" name="l00710"></a><span class="lineno">  710</span>    <span class="keyword">const</span> <span class="keyword">auto</span> offers = KPackage::PackageLoader::self()-&gt;listPackages(QStringLiteral(<span class="stringliteral">&quot;KWin/Script&quot;</span>), scriptFolder);</div>
<div class="line"><a id="l00711" name="l00711"></a><span class="lineno">  711</span> </div>
<div class="line"><a id="l00712" name="l00712"></a><span class="lineno">  712</span>    <a class="code hl_typedef" href="scripting_8h.html#afb5c13d7e637b8983a9e532a0b6dcbfe">LoadScriptList</a> scriptsToLoad;</div>
<div class="line"><a id="l00713" name="l00713"></a><span class="lineno">  713</span> </div>
<div class="line"><a id="l00714" name="l00714"></a><span class="lineno">  714</span>    <span class="keywordflow">for</span> (<span class="keyword">const</span> KPluginMetaData &amp;service : offers) {</div>
<div class="line"><a id="l00715" name="l00715"></a><span class="lineno">  715</span>        <span class="keyword">const</span> QString value = pluginStates.value(service.pluginId() + QLatin1String(<span class="stringliteral">&quot;Enabled&quot;</span>), QString());</div>
<div class="line"><a id="l00716" name="l00716"></a><span class="lineno">  716</span>        <span class="keyword">const</span> <span class="keywordtype">bool</span> enabled = value.isNull() ? service.isEnabledByDefault() : QVariant(value).toBool();</div>
<div class="line"><a id="l00717" name="l00717"></a><span class="lineno">  717</span>        <span class="keyword">const</span> <span class="keywordtype">bool</span> javaScript = service.value(QStringLiteral(<span class="stringliteral">&quot;X-Plasma-API&quot;</span>)) == QLatin1String(<span class="stringliteral">&quot;javascript&quot;</span>);</div>
<div class="line"><a id="l00718" name="l00718"></a><span class="lineno">  718</span>        <span class="keyword">const</span> <span class="keywordtype">bool</span> declarativeScript = service.value(QStringLiteral(<span class="stringliteral">&quot;X-Plasma-API&quot;</span>)) == QLatin1String(<span class="stringliteral">&quot;declarativescript&quot;</span>);</div>
<div class="line"><a id="l00719" name="l00719"></a><span class="lineno">  719</span>        <span class="keywordflow">if</span> (!javaScript &amp;&amp; !declarativeScript) {</div>
<div class="line"><a id="l00720" name="l00720"></a><span class="lineno">  720</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00721" name="l00721"></a><span class="lineno">  721</span>        }</div>
<div class="line"><a id="l00722" name="l00722"></a><span class="lineno">  722</span> </div>
<div class="line"><a id="l00723" name="l00723"></a><span class="lineno">  723</span>        <span class="keywordflow">if</span> (!enabled) {</div>
<div class="line"><a id="l00724" name="l00724"></a><span class="lineno">  724</span>            <span class="keywordflow">if</span> (isScriptLoaded(service.pluginId())) {</div>
<div class="line"><a id="l00725" name="l00725"></a><span class="lineno">  725</span>                <span class="comment">// unload the script</span></div>
<div class="line"><a id="l00726" name="l00726"></a><span class="lineno">  726</span>                unloadScript(service.pluginId());</div>
<div class="line"><a id="l00727" name="l00727"></a><span class="lineno">  727</span>            }</div>
<div class="line"><a id="l00728" name="l00728"></a><span class="lineno">  728</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00729" name="l00729"></a><span class="lineno">  729</span>        }</div>
<div class="line"><a id="l00730" name="l00730"></a><span class="lineno">  730</span>        <span class="keyword">const</span> QString pluginName = service.pluginId();</div>
<div class="line"><a id="l00731" name="l00731"></a><span class="lineno">  731</span>        <span class="comment">// The file we want to load depends on the specified API. We could check if one or the other file exists, but that is more error prone and causes IO overhead</span></div>
<div class="line"><a id="l00732" name="l00732"></a><span class="lineno">  732</span>        <span class="keyword">const</span> QString relScriptPath = scriptFolder + pluginName + QLatin1String(<span class="stringliteral">&quot;/contents/&quot;</span>) + (javaScript ? QLatin1String(<span class="stringliteral">&quot;code/main.js&quot;</span>) : QLatin1String(<span class="stringliteral">&quot;ui/main.qml&quot;</span>));</div>
<div class="line"><a id="l00733" name="l00733"></a><span class="lineno">  733</span>        <span class="keyword">const</span> QString file = QStandardPaths::locate(QStandardPaths::GenericDataLocation, relScriptPath);</div>
<div class="line"><a id="l00734" name="l00734"></a><span class="lineno">  734</span>        <span class="keywordflow">if</span> (file.isEmpty()) {</div>
<div class="line"><a id="l00735" name="l00735"></a><span class="lineno">  735</span>            qCDebug(KWIN_SCRIPTING) &lt;&lt; <span class="stringliteral">&quot;Could not find script file for &quot;</span> &lt;&lt; pluginName;</div>
<div class="line"><a id="l00736" name="l00736"></a><span class="lineno">  736</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00737" name="l00737"></a><span class="lineno">  737</span>        }</div>
<div class="line"><a id="l00738" name="l00738"></a><span class="lineno">  738</span>        scriptsToLoad &lt;&lt; qMakePair(javaScript, qMakePair(file, pluginName));</div>
<div class="line"><a id="l00739" name="l00739"></a><span class="lineno">  739</span>    }</div>
<div class="line"><a id="l00740" name="l00740"></a><span class="lineno">  740</span>    <span class="keywordflow">return</span> scriptsToLoad;</div>
<div class="line"><a id="l00741" name="l00741"></a><span class="lineno">  741</span>}</div>
<div class="line"><a id="l00742" name="l00742"></a><span class="lineno">  742</span> </div>
<div class="line"><a id="l00743" name="l00743"></a><span class="lineno">  743</span><span class="keywordtype">void</span> KWin::Scripting::slotScriptsQueried()</div>
<div class="line"><a id="l00744" name="l00744"></a><span class="lineno">  744</span>{</div>
<div class="line"><a id="l00745" name="l00745"></a><span class="lineno">  745</span>    <a class="code hl_class" href="class_q_future_watcher.html">QFutureWatcher&lt;LoadScriptList&gt;</a> *watcher = <span class="keyword">dynamic_cast&lt;</span><a class="code hl_class" href="class_q_future_watcher.html">QFutureWatcher&lt;LoadScriptList&gt;</a> *<span class="keyword">&gt;</span>(sender());</div>
<div class="line"><a id="l00746" name="l00746"></a><span class="lineno">  746</span>    <span class="keywordflow">if</span> (!watcher) {</div>
<div class="line"><a id="l00747" name="l00747"></a><span class="lineno">  747</span>        <span class="comment">// slot invoked not from a FutureWatcher</span></div>
<div class="line"><a id="l00748" name="l00748"></a><span class="lineno">  748</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00749" name="l00749"></a><span class="lineno">  749</span>    }</div>
<div class="line"><a id="l00750" name="l00750"></a><span class="lineno">  750</span> </div>
<div class="line"><a id="l00751" name="l00751"></a><span class="lineno">  751</span>    <a class="code hl_typedef" href="scripting_8h.html#afb5c13d7e637b8983a9e532a0b6dcbfe">LoadScriptList</a> scriptsToLoad = watcher-&gt;result();</div>
<div class="line"><a id="l00752" name="l00752"></a><span class="lineno">  752</span>    <span class="keywordflow">for</span> (LoadScriptList::const_iterator it = scriptsToLoad.constBegin();</div>
<div class="line"><a id="l00753" name="l00753"></a><span class="lineno">  753</span>         it != scriptsToLoad.constEnd();</div>
<div class="line"><a id="l00754" name="l00754"></a><span class="lineno">  754</span>         ++it) {</div>
<div class="line"><a id="l00755" name="l00755"></a><span class="lineno">  755</span>        <span class="keywordflow">if</span> (it-&gt;first) {</div>
<div class="line"><a id="l00756" name="l00756"></a><span class="lineno">  756</span>            loadScript(it-&gt;second.first, it-&gt;second.second);</div>
<div class="line"><a id="l00757" name="l00757"></a><span class="lineno">  757</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00758" name="l00758"></a><span class="lineno">  758</span>            loadDeclarativeScript(it-&gt;second.first, it-&gt;second.second);</div>
<div class="line"><a id="l00759" name="l00759"></a><span class="lineno">  759</span>        }</div>
<div class="line"><a id="l00760" name="l00760"></a><span class="lineno">  760</span>    }</div>
<div class="line"><a id="l00761" name="l00761"></a><span class="lineno">  761</span> </div>
<div class="line"><a id="l00762" name="l00762"></a><span class="lineno">  762</span>    runScripts();</div>
<div class="line"><a id="l00763" name="l00763"></a><span class="lineno">  763</span>    watcher-&gt;deleteLater();</div>
<div class="line"><a id="l00764" name="l00764"></a><span class="lineno">  764</span>}</div>
<div class="line"><a id="l00765" name="l00765"></a><span class="lineno">  765</span> </div>
<div class="foldopen" id="foldopen00766" data-start="{" data-end="}">
<div class="line"><a id="l00766" name="l00766"></a><span class="lineno"><a class="line" href="class_k_win_1_1_scripting.html#a4e2286c762b2e3294fed7cbcfc46453b">  766</a></span><span class="keywordtype">bool</span> <a class="code hl_function" href="class_k_win_1_1_scripting.html#a4e2286c762b2e3294fed7cbcfc46453b">KWin::Scripting::isScriptLoaded</a>(<span class="keyword">const</span> QString &amp;pluginName)<span class="keyword"> const</span></div>
<div class="line"><a id="l00767" name="l00767"></a><span class="lineno">  767</span><span class="keyword"></span>{</div>
<div class="line"><a id="l00768" name="l00768"></a><span class="lineno">  768</span>    <span class="keywordflow">return</span> findScript(pluginName) != <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00769" name="l00769"></a><span class="lineno">  769</span>}</div>
</div>
<div class="line"><a id="l00770" name="l00770"></a><span class="lineno">  770</span> </div>
<div class="foldopen" id="foldopen00771" data-start="{" data-end="}">
<div class="line"><a id="l00771" name="l00771"></a><span class="lineno"><a class="line" href="class_k_win_1_1_scripting.html#a157a8abdd6f6b334e80f9cd2ba697494">  771</a></span><a class="code hl_class" href="class_k_win_1_1_abstract_script.html">KWin::AbstractScript</a> *<a class="code hl_function" href="class_k_win_1_1_scripting.html#a157a8abdd6f6b334e80f9cd2ba697494">KWin::Scripting::findScript</a>(<span class="keyword">const</span> QString &amp;pluginName)<span class="keyword"> const</span></div>
<div class="line"><a id="l00772" name="l00772"></a><span class="lineno">  772</span><span class="keyword"></span>{</div>
<div class="line"><a id="l00773" name="l00773"></a><span class="lineno">  773</span>    QMutexLocker locker(m_scriptsLock.get());</div>
<div class="line"><a id="l00774" name="l00774"></a><span class="lineno">  774</span>    <span class="keywordflow">for</span> (<a class="code hl_class" href="class_k_win_1_1_abstract_script.html">AbstractScript</a> *script : std::as_const(scripts)) {</div>
<div class="line"><a id="l00775" name="l00775"></a><span class="lineno">  775</span>        <span class="keywordflow">if</span> (script-&gt;pluginName() == pluginName) {</div>
<div class="line"><a id="l00776" name="l00776"></a><span class="lineno">  776</span>            <span class="keywordflow">return</span> script;</div>
<div class="line"><a id="l00777" name="l00777"></a><span class="lineno">  777</span>        }</div>
<div class="line"><a id="l00778" name="l00778"></a><span class="lineno">  778</span>    }</div>
<div class="line"><a id="l00779" name="l00779"></a><span class="lineno">  779</span>    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00780" name="l00780"></a><span class="lineno">  780</span>}</div>
</div>
<div class="line"><a id="l00781" name="l00781"></a><span class="lineno">  781</span> </div>
<div class="foldopen" id="foldopen00782" data-start="{" data-end="}">
<div class="line"><a id="l00782" name="l00782"></a><span class="lineno"><a class="line" href="class_k_win_1_1_scripting.html#a86614b2061d94f0aa87c28ffc9f790da">  782</a></span><span class="keywordtype">bool</span> <a class="code hl_function" href="class_k_win_1_1_scripting.html#a86614b2061d94f0aa87c28ffc9f790da">KWin::Scripting::unloadScript</a>(<span class="keyword">const</span> QString &amp;pluginName)</div>
<div class="line"><a id="l00783" name="l00783"></a><span class="lineno">  783</span>{</div>
<div class="line"><a id="l00784" name="l00784"></a><span class="lineno">  784</span>    QMutexLocker locker(m_scriptsLock.get());</div>
<div class="line"><a id="l00785" name="l00785"></a><span class="lineno">  785</span>    <span class="keywordflow">for</span> (<a class="code hl_class" href="class_k_win_1_1_abstract_script.html">AbstractScript</a> *script : std::as_const(scripts)) {</div>
<div class="line"><a id="l00786" name="l00786"></a><span class="lineno">  786</span>        <span class="keywordflow">if</span> (script-&gt;pluginName() == pluginName) {</div>
<div class="line"><a id="l00787" name="l00787"></a><span class="lineno">  787</span>            script-&gt;deleteLater();</div>
<div class="line"><a id="l00788" name="l00788"></a><span class="lineno">  788</span>            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00789" name="l00789"></a><span class="lineno">  789</span>        }</div>
<div class="line"><a id="l00790" name="l00790"></a><span class="lineno">  790</span>    }</div>
<div class="line"><a id="l00791" name="l00791"></a><span class="lineno">  791</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00792" name="l00792"></a><span class="lineno">  792</span>}</div>
</div>
<div class="line"><a id="l00793" name="l00793"></a><span class="lineno">  793</span> </div>
<div class="line"><a id="l00794" name="l00794"></a><span class="lineno">  794</span><span class="keywordtype">void</span> KWin::Scripting::runScripts()</div>
<div class="line"><a id="l00795" name="l00795"></a><span class="lineno">  795</span>{</div>
<div class="line"><a id="l00796" name="l00796"></a><span class="lineno">  796</span>    QMutexLocker locker(m_scriptsLock.get());</div>
<div class="line"><a id="l00797" name="l00797"></a><span class="lineno">  797</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; scripts.size(); i++) {</div>
<div class="line"><a id="l00798" name="l00798"></a><span class="lineno">  798</span>        scripts.at(i)-&gt;run();</div>
<div class="line"><a id="l00799" name="l00799"></a><span class="lineno">  799</span>    }</div>
<div class="line"><a id="l00800" name="l00800"></a><span class="lineno">  800</span>}</div>
<div class="line"><a id="l00801" name="l00801"></a><span class="lineno">  801</span> </div>
<div class="foldopen" id="foldopen00802" data-start="{" data-end="}">
<div class="line"><a id="l00802" name="l00802"></a><span class="lineno"><a class="line" href="class_k_win_1_1_scripting.html#ae71adccb69f6bedc04645d52245b869a">  802</a></span><span class="keywordtype">void</span> <a class="code hl_slot" href="class_k_win_1_1_scripting.html#ae71adccb69f6bedc04645d52245b869a">KWin::Scripting::scriptDestroyed</a>(QObject *<span class="keywordtype">object</span>)</div>
<div class="line"><a id="l00803" name="l00803"></a><span class="lineno">  803</span>{</div>
<div class="line"><a id="l00804" name="l00804"></a><span class="lineno">  804</span>    QMutexLocker locker(m_scriptsLock.get());</div>
<div class="line"><a id="l00805" name="l00805"></a><span class="lineno">  805</span>    scripts.removeAll(<span class="keyword">static_cast&lt;</span><a class="code hl_class" href="class_k_win_1_1_script.html">KWin::Script</a> *<span class="keyword">&gt;</span>(<span class="keywordtype">object</span>));</div>
<div class="line"><a id="l00806" name="l00806"></a><span class="lineno">  806</span>}</div>
</div>
<div class="line"><a id="l00807" name="l00807"></a><span class="lineno">  807</span> </div>
<div class="foldopen" id="foldopen00808" data-start="{" data-end="}">
<div class="line"><a id="l00808" name="l00808"></a><span class="lineno"><a class="line" href="class_k_win_1_1_scripting.html#adb86674cfb829b7b89bc88556db9a29f">  808</a></span><span class="keywordtype">int</span> <a class="code hl_function" href="class_k_win_1_1_scripting.html#adb86674cfb829b7b89bc88556db9a29f">KWin::Scripting::loadScript</a>(<span class="keyword">const</span> QString &amp;filePath, <span class="keyword">const</span> QString &amp;pluginName)</div>
<div class="line"><a id="l00809" name="l00809"></a><span class="lineno">  809</span>{</div>
<div class="line"><a id="l00810" name="l00810"></a><span class="lineno">  810</span>    QMutexLocker locker(m_scriptsLock.get());</div>
<div class="line"><a id="l00811" name="l00811"></a><span class="lineno">  811</span>    <span class="keywordflow">if</span> (isScriptLoaded(pluginName)) {</div>
<div class="line"><a id="l00812" name="l00812"></a><span class="lineno">  812</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a id="l00813" name="l00813"></a><span class="lineno">  813</span>    }</div>
<div class="line"><a id="l00814" name="l00814"></a><span class="lineno">  814</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> <span class="keywordtype">id</span> = scripts.size();</div>
<div class="line"><a id="l00815" name="l00815"></a><span class="lineno">  815</span>    <a class="code hl_class" href="class_k_win_1_1_script.html">KWin::Script</a> *script = <span class="keyword">new</span> <a class="code hl_class" href="class_k_win_1_1_script.html">KWin::Script</a>(<span class="keywordtype">id</span>, filePath, pluginName, <span class="keyword">this</span>);</div>
<div class="line"><a id="l00816" name="l00816"></a><span class="lineno">  816</span>    connect(script, &amp;QObject::destroyed, <span class="keyword">this</span>, &amp;<a class="code hl_slot" href="class_k_win_1_1_scripting.html#ae71adccb69f6bedc04645d52245b869a">Scripting::scriptDestroyed</a>);</div>
<div class="line"><a id="l00817" name="l00817"></a><span class="lineno">  817</span>    scripts.append(script);</div>
<div class="line"><a id="l00818" name="l00818"></a><span class="lineno">  818</span>    <span class="keywordflow">return</span> id;</div>
<div class="line"><a id="l00819" name="l00819"></a><span class="lineno">  819</span>}</div>
</div>
<div class="line"><a id="l00820" name="l00820"></a><span class="lineno">  820</span> </div>
<div class="foldopen" id="foldopen00821" data-start="{" data-end="}">
<div class="line"><a id="l00821" name="l00821"></a><span class="lineno"><a class="line" href="class_k_win_1_1_scripting.html#acb0eac88b1d79c1718eb83d301493d7a">  821</a></span><span class="keywordtype">int</span> <a class="code hl_function" href="class_k_win_1_1_scripting.html#acb0eac88b1d79c1718eb83d301493d7a">KWin::Scripting::loadDeclarativeScript</a>(<span class="keyword">const</span> QString &amp;filePath, <span class="keyword">const</span> QString &amp;pluginName)</div>
<div class="line"><a id="l00822" name="l00822"></a><span class="lineno">  822</span>{</div>
<div class="line"><a id="l00823" name="l00823"></a><span class="lineno">  823</span>    QMutexLocker locker(m_scriptsLock.get());</div>
<div class="line"><a id="l00824" name="l00824"></a><span class="lineno">  824</span>    <span class="keywordflow">if</span> (isScriptLoaded(pluginName)) {</div>
<div class="line"><a id="l00825" name="l00825"></a><span class="lineno">  825</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a id="l00826" name="l00826"></a><span class="lineno">  826</span>    }</div>
<div class="line"><a id="l00827" name="l00827"></a><span class="lineno">  827</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> <span class="keywordtype">id</span> = scripts.size();</div>
<div class="line"><a id="l00828" name="l00828"></a><span class="lineno">  828</span>    <a class="code hl_class" href="class_k_win_1_1_declarative_script.html">KWin::DeclarativeScript</a> *script = <span class="keyword">new</span> <a class="code hl_class" href="class_k_win_1_1_declarative_script.html">KWin::DeclarativeScript</a>(<span class="keywordtype">id</span>, filePath, pluginName, <span class="keyword">this</span>);</div>
<div class="line"><a id="l00829" name="l00829"></a><span class="lineno">  829</span>    connect(script, &amp;QObject::destroyed, <span class="keyword">this</span>, &amp;<a class="code hl_slot" href="class_k_win_1_1_scripting.html#ae71adccb69f6bedc04645d52245b869a">Scripting::scriptDestroyed</a>);</div>
<div class="line"><a id="l00830" name="l00830"></a><span class="lineno">  830</span>    scripts.append(script);</div>
<div class="line"><a id="l00831" name="l00831"></a><span class="lineno">  831</span>    <span class="keywordflow">return</span> id;</div>
<div class="line"><a id="l00832" name="l00832"></a><span class="lineno">  832</span>}</div>
</div>
<div class="line"><a id="l00833" name="l00833"></a><span class="lineno">  833</span> </div>
<div class="foldopen" id="foldopen00834" data-start="{" data-end="}">
<div class="line"><a id="l00834" name="l00834"></a><span class="lineno"><a class="line" href="class_k_win_1_1_scripting.html#a82be76e174d5f13e24ee8751ef17fc56">  834</a></span><a class="code hl_function" href="class_k_win_1_1_scripting.html#a82be76e174d5f13e24ee8751ef17fc56">KWin::Scripting::~Scripting</a>()</div>
<div class="line"><a id="l00835" name="l00835"></a><span class="lineno">  835</span>{</div>
<div class="line"><a id="l00836" name="l00836"></a><span class="lineno">  836</span>    QDBusConnection::sessionBus().unregisterObject(QStringLiteral(<span class="stringliteral">&quot;/Scripting&quot;</span>));</div>
<div class="line"><a id="l00837" name="l00837"></a><span class="lineno">  837</span>    s_self = <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00838" name="l00838"></a><span class="lineno">  838</span>}</div>
</div>
<div class="line"><a id="l00839" name="l00839"></a><span class="lineno">  839</span> </div>
<div class="foldopen" id="foldopen00840" data-start="{" data-end="}">
<div class="line"><a id="l00840" name="l00840"></a><span class="lineno"><a class="line" href="class_k_win_1_1_scripting.html#aac1399c98e9a5912716fedbe711eaca4">  840</a></span>QList&lt;QAction *&gt; <a class="code hl_function" href="class_k_win_1_1_scripting.html#aac1399c98e9a5912716fedbe711eaca4">KWin::Scripting::actionsForUserActionMenu</a>(<a class="code hl_class" href="class_k_win_1_1_window.html">KWin::Window</a> *c, QMenu *parent)</div>
<div class="line"><a id="l00841" name="l00841"></a><span class="lineno">  841</span>{</div>
<div class="line"><a id="l00842" name="l00842"></a><span class="lineno">  842</span>    QList&lt;QAction *&gt; actions;</div>
<div class="line"><a id="l00843" name="l00843"></a><span class="lineno">  843</span>    <span class="keywordflow">for</span> (<a class="code hl_class" href="class_k_win_1_1_abstract_script.html">AbstractScript</a> *s : std::as_const(scripts)) {</div>
<div class="line"><a id="l00844" name="l00844"></a><span class="lineno">  844</span>        <span class="comment">// TODO: Allow declarative scripts to add their own user actions.</span></div>
<div class="line"><a id="l00845" name="l00845"></a><span class="lineno">  845</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="class_k_win_1_1_script.html">Script</a> *script = qobject_cast&lt;Script *&gt;(s)) {</div>
<div class="line"><a id="l00846" name="l00846"></a><span class="lineno">  846</span>            actions &lt;&lt; script-&gt;actionsForUserActionMenu(c, parent);</div>
<div class="line"><a id="l00847" name="l00847"></a><span class="lineno">  847</span>        }</div>
<div class="line"><a id="l00848" name="l00848"></a><span class="lineno">  848</span>    }</div>
<div class="line"><a id="l00849" name="l00849"></a><span class="lineno">  849</span>    <span class="keywordflow">return</span> actions;</div>
<div class="line"><a id="l00850" name="l00850"></a><span class="lineno">  850</span>}</div>
</div>
<div class="line"><a id="l00851" name="l00851"></a><span class="lineno">  851</span> </div>
<div class="line"><a id="l00852" name="l00852"></a><span class="lineno">  852</span><span class="preprocessor">#include &quot;moc_scripting.cpp&quot;</span></div>
<div class="ttc" id="aclass_k_win_1_1_abstract_script_html"><div class="ttname"><a href="class_k_win_1_1_abstract_script.html">KWin::AbstractScript</a></div><div class="ttdef"><b>Definition</b> <a href="scripting_8h_source.html#l00042">scripting.h:43</a></div></div>
<div class="ttc" id="aclass_k_win_1_1_abstract_script_html_a76d921a0d06d2d9e3783739c683225d5"><div class="ttname"><a href="class_k_win_1_1_abstract_script.html#a76d921a0d06d2d9e3783739c683225d5">KWin::AbstractScript::AbstractScript</a></div><div class="ttdeci">AbstractScript(int id, QString scriptName, QString pluginName, QObject *parent=nullptr)</div><div class="ttdef"><b>Definition</b> <a href="#l00098">scripting.cpp:98</a></div></div>
<div class="ttc" id="aclass_k_win_1_1_abstract_script_html_ad09c6008ab7e5629b49af42a3bf3271d"><div class="ttname"><a href="class_k_win_1_1_abstract_script.html#ad09c6008ab7e5629b49af42a3bf3271d">KWin::AbstractScript::stop</a></div><div class="ttdeci">void stop()</div><div class="ttdef"><b>Definition</b> <a href="#l00122">scripting.cpp:122</a></div></div>
<div class="ttc" id="aclass_k_win_1_1_abstract_script_html_adedebe311021f5d95fe467faeffca8dc"><div class="ttname"><a href="class_k_win_1_1_abstract_script.html#adedebe311021f5d95fe467faeffca8dc">KWin::AbstractScript::config</a></div><div class="ttdeci">KConfigGroup config() const</div><div class="ttdef"><b>Definition</b> <a href="#l00117">scripting.cpp:117</a></div></div>
<div class="ttc" id="aclass_k_win_1_1_abstract_script_html_ae8f1f9aa3f49d4ff42404fcc272ab4f5"><div class="ttname"><a href="class_k_win_1_1_abstract_script.html#ae8f1f9aa3f49d4ff42404fcc272ab4f5">KWin::AbstractScript::scriptId</a></div><div class="ttdeci">int scriptId() const</div><div class="ttdef"><b>Definition</b> <a href="scripting_8h_source.html#l00048">scripting.h:48</a></div></div>
<div class="ttc" id="aclass_k_win_1_1_abstract_script_html_afac9b3c7d793923982af2b2919bca2c8"><div class="ttname"><a href="class_k_win_1_1_abstract_script.html#afac9b3c7d793923982af2b2919bca2c8">KWin::AbstractScript::~AbstractScript</a></div><div class="ttdeci">~AbstractScript() override</div><div class="ttdef"><b>Definition</b> <a href="#l00113">scripting.cpp:113</a></div></div>
<div class="ttc" id="aclass_k_win_1_1_declarative_script_html"><div class="ttname"><a href="class_k_win_1_1_declarative_script.html">KWin::DeclarativeScript</a></div><div class="ttdef"><b>Definition</b> <a href="scripting_8h_source.html#l00252">scripting.h:253</a></div></div>
<div class="ttc" id="aclass_k_win_1_1_declarative_script_html_a18b787cd3ad89dd5b3e64c71f15cf1ce"><div class="ttname"><a href="class_k_win_1_1_declarative_script.html#a18b787cd3ad89dd5b3e64c71f15cf1ce">KWin::DeclarativeScript::run</a></div><div class="ttdeci">Q_SCRIPTABLE void run() override</div><div class="ttdef"><b>Definition</b> <a href="#l00575">scripting.cpp:575</a></div></div>
<div class="ttc" id="aclass_k_win_1_1_declarative_script_html_a45d299727e1402417c866b50be01f9b3"><div class="ttname"><a href="class_k_win_1_1_declarative_script.html#a45d299727e1402417c866b50be01f9b3">KWin::DeclarativeScript::~DeclarativeScript</a></div><div class="ttdeci">~DeclarativeScript() override</div><div class="ttdef"><b>Definition</b> <a href="#l00571">scripting.cpp:571</a></div></div>
<div class="ttc" id="aclass_k_win_1_1_declarative_script_html_ad4aaeff1be15700c211a59639370080a"><div class="ttname"><a href="class_k_win_1_1_declarative_script.html#ad4aaeff1be15700c211a59639370080a">KWin::DeclarativeScript::DeclarativeScript</a></div><div class="ttdeci">DeclarativeScript(int id, QString scriptName, QString pluginName, QObject *parent=nullptr)</div><div class="ttdef"><b>Definition</b> <a href="#l00563">scripting.cpp:563</a></div></div>
<div class="ttc" id="aclass_k_win_1_1_j_s_engine_global_methods_wrapper_html"><div class="ttname"><a href="class_k_win_1_1_j_s_engine_global_methods_wrapper.html">KWin::JSEngineGlobalMethodsWrapper</a></div><div class="ttdef"><b>Definition</b> <a href="scripting_8h_source.html#l00270">scripting.h:271</a></div></div>
<div class="ttc" id="aclass_k_win_1_1_j_s_engine_global_methods_wrapper_html_a3afaf6bda1eba512517dff706e9b826b"><div class="ttname"><a href="class_k_win_1_1_j_s_engine_global_methods_wrapper.html#a3afaf6bda1eba512517dff706e9b826b">KWin::JSEngineGlobalMethodsWrapper::~JSEngineGlobalMethodsWrapper</a></div><div class="ttdeci">~JSEngineGlobalMethodsWrapper() override</div><div class="ttdef"><b>Definition</b> <a href="#l00607">scripting.cpp:607</a></div></div>
<div class="ttc" id="aclass_k_win_1_1_j_s_engine_global_methods_wrapper_html_aa7a620aa9f819d9e2429f2acffbf0b80"><div class="ttname"><a href="class_k_win_1_1_j_s_engine_global_methods_wrapper.html#aa7a620aa9f819d9e2429f2acffbf0b80">KWin::JSEngineGlobalMethodsWrapper::JSEngineGlobalMethodsWrapper</a></div><div class="ttdeci">JSEngineGlobalMethodsWrapper(DeclarativeScript *parent)</div><div class="ttdef"><b>Definition</b> <a href="#l00601">scripting.cpp:601</a></div></div>
<div class="ttc" id="aclass_k_win_1_1_j_s_engine_global_methods_wrapper_html_ad1a68caccb57532305c08717beaf36db"><div class="ttname"><a href="class_k_win_1_1_j_s_engine_global_methods_wrapper.html#ad1a68caccb57532305c08717beaf36db">KWin::JSEngineGlobalMethodsWrapper::readConfig</a></div><div class="ttdeci">QVariant readConfig(const QString &amp;key, QVariant defaultValue=QVariant())</div><div class="ttdef"><b>Definition</b> <a href="#l00611">scripting.cpp:611</a></div></div>
<div class="ttc" id="aclass_k_win_1_1_qt_script_workspace_wrapper_html"><div class="ttname"><a href="class_k_win_1_1_qt_script_workspace_wrapper.html">KWin::QtScriptWorkspaceWrapper</a></div><div class="ttdef"><b>Definition</b> <a href="workspace__wrapper_8h_source.html#l00364">workspace_wrapper.h:365</a></div></div>
<div class="ttc" id="aclass_k_win_1_1_screen_edges_html_a26e8b8046e90de4811253d87de67477d"><div class="ttname"><a href="class_k_win_1_1_screen_edges.html#a26e8b8046e90de4811253d87de67477d">KWin::ScreenEdges::reserve</a></div><div class="ttdeci">void reserve(ElectricBorder border, QObject *object, const char *callback)</div><div class="ttdef"><b>Definition</b> <a href="screenedge_8cpp_source.html#l01279">screenedge.cpp:1279</a></div></div>
<div class="ttc" id="aclass_k_win_1_1_screen_edges_html_aaee4026fa795568ea3217b1d70cd4234"><div class="ttname"><a href="class_k_win_1_1_screen_edges.html#aaee4026fa795568ea3217b1d70cd4234">KWin::ScreenEdges::unreserve</a></div><div class="ttdeci">void unreserve(ElectricBorder border, QObject *object)</div><div class="ttdef"><b>Definition</b> <a href="screenedge_8cpp_source.html#l01288">screenedge.cpp:1288</a></div></div>
<div class="ttc" id="aclass_k_win_1_1_screen_edges_html_abdd24d5b332b226ad4b3b84d79979721"><div class="ttname"><a href="class_k_win_1_1_screen_edges.html#abdd24d5b332b226ad4b3b84d79979721">KWin::ScreenEdges::reserveTouch</a></div><div class="ttdeci">void reserveTouch(ElectricBorder border, QAction *action, TouchCallback::CallbackFunction callback=nullptr)</div><div class="ttdef"><b>Definition</b> <a href="screenedge_8cpp_source.html#l01312">screenedge.cpp:1312</a></div></div>
<div class="ttc" id="aclass_k_win_1_1_script_html"><div class="ttname"><a href="class_k_win_1_1_script.html">KWin::Script</a></div><div class="ttdef"><b>Definition</b> <a href="scripting_8h_source.html#l00103">scripting.h:104</a></div></div>
<div class="ttc" id="aclass_k_win_1_1_script_html_a21611e13f0afa92b37842baf67294599"><div class="ttname"><a href="class_k_win_1_1_script.html#a21611e13f0afa92b37842baf67294599">KWin::Script::readConfig</a></div><div class="ttdeci">Q_INVOKABLE QVariant readConfig(const QString &amp;key, const QVariant &amp;defaultValue=QVariant())</div><div class="ttdef"><b>Definition</b> <a href="#l00294">scripting.cpp:294</a></div></div>
<div class="ttc" id="aclass_k_win_1_1_script_html_a3c166d77163bd5f8f1212aa2b0b9c103"><div class="ttname"><a href="class_k_win_1_1_script.html#a3c166d77163bd5f8f1212aa2b0b9c103">KWin::Script::unregisterTouchScreenEdge</a></div><div class="ttdeci">Q_INVOKABLE bool unregisterTouchScreenEdge(int edge)</div><div class="ttdef"><b>Definition</b> <a href="#l00446">scripting.cpp:446</a></div></div>
<div class="ttc" id="aclass_k_win_1_1_script_html_a5386a6cb0c28b8bdf1538adc8808fac9"><div class="ttname"><a href="class_k_win_1_1_script.html#a5386a6cb0c28b8bdf1538adc8808fac9">KWin::Script::Script</a></div><div class="ttdeci">Script(int id, QString scriptName, QString pluginName, QObject *parent=nullptr)</div><div class="ttdef"><b>Definition</b> <a href="#l00132">scripting.cpp:132</a></div></div>
<div class="ttc" id="aclass_k_win_1_1_script_html_a585c5d02390b9e2b6ae7f77fbfdf4e4a"><div class="ttname"><a href="class_k_win_1_1_script.html#a585c5d02390b9e2b6ae7f77fbfdf4e4a">KWin::Script::callDBus</a></div><div class="ttdeci">Q_INVOKABLE void callDBus(const QString &amp;service, const QString &amp;path, const QString &amp;interface, const QString &amp;method, const QJSValue &amp;arg1=QJSValue(), const QJSValue &amp;arg2=QJSValue(), const QJSValue &amp;arg3=QJSValue(), const QJSValue &amp;arg4=QJSValue(), const QJSValue &amp;arg5=QJSValue(), const QJSValue &amp;arg6=QJSValue(), const QJSValue &amp;arg7=QJSValue(), const QJSValue &amp;arg8=QJSValue(), const QJSValue &amp;arg9=QJSValue())</div><div class="ttdef"><b>Definition</b> <a href="#l00299">scripting.cpp:299</a></div></div>
<div class="ttc" id="aclass_k_win_1_1_script_html_a5c248700c9be5f45686920811c53f397"><div class="ttname"><a href="class_k_win_1_1_script.html#a5c248700c9be5f45686920811c53f397">KWin::Script::registerTouchScreenEdge</a></div><div class="ttdeci">Q_INVOKABLE bool registerTouchScreenEdge(int edge, const QJSValue &amp;callback)</div><div class="ttdef"><b>Definition</b> <a href="#l00425">scripting.cpp:425</a></div></div>
<div class="ttc" id="aclass_k_win_1_1_script_html_a5f98b562df6f7281531e4baaac9f7bfa"><div class="ttname"><a href="class_k_win_1_1_script.html#a5f98b562df6f7281531e4baaac9f7bfa">KWin::Script::run</a></div><div class="ttdeci">void run() override</div><div class="ttdef"><b>Definition</b> <a href="#l00164">scripting.cpp:164</a></div></div>
<div class="ttc" id="aclass_k_win_1_1_script_html_a67c2e733f5d2bd4ecfccd69b9cae7721"><div class="ttname"><a href="class_k_win_1_1_script.html#a67c2e733f5d2bd4ecfccd69b9cae7721">KWin::Script::registerShortcut</a></div><div class="ttdeci">Q_INVOKABLE bool registerShortcut(const QString &amp;objectName, const QString &amp;text, const QString &amp;keySequence, const QJSValue &amp;callback)</div><div class="ttdef"><b>Definition</b> <a href="#l00374">scripting.cpp:374</a></div></div>
<div class="ttc" id="aclass_k_win_1_1_script_html_a71b2899512833c0f332ceb2e2dbd7087"><div class="ttname"><a href="class_k_win_1_1_script.html#a71b2899512833c0f332ceb2e2dbd7087">KWin::Script::actionsForUserActionMenu</a></div><div class="ttdeci">QList&lt; QAction * &gt; actionsForUserActionMenu(Window *client, QMenu *parent)</div><div class="ttdoc">Creates actions for the UserActionsMenu by invoking the registered callbacks.</div><div class="ttdef"><b>Definition</b> <a href="#l00468">scripting.cpp:468</a></div></div>
<div class="ttc" id="aclass_k_win_1_1_script_html_a86b6b20a771b7f03a51e127b2dca4459"><div class="ttname"><a href="class_k_win_1_1_script.html#a86b6b20a771b7f03a51e127b2dca4459">KWin::Script::~Script</a></div><div class="ttdeci">virtual ~Script()</div><div class="ttdef"><b>Definition</b> <a href="#l00160">scripting.cpp:160</a></div></div>
<div class="ttc" id="aclass_k_win_1_1_script_html_abf13a1ea2aa7473b508aded77caa8c2b"><div class="ttname"><a href="class_k_win_1_1_script.html#abf13a1ea2aa7473b508aded77caa8c2b">KWin::Script::registerUserActionsMenu</a></div><div class="ttdeci">Q_INVOKABLE void registerUserActionsMenu(const QJSValue &amp;callback)</div><div class="ttdoc">Registers the given callback to be invoked whenever the UserActionsMenu is about to be showed....</div><div class="ttdef"><b>Definition</b> <a href="#l00459">scripting.cpp:459</a></div></div>
<div class="ttc" id="aclass_k_win_1_1_script_html_ad1d31827251be0938d99afeb9c75fb15"><div class="ttname"><a href="class_k_win_1_1_script.html#ad1d31827251be0938d99afeb9c75fb15">KWin::Script::unregisterScreenEdge</a></div><div class="ttdeci">Q_INVOKABLE bool unregisterScreenEdge(int edge)</div><div class="ttdef"><b>Definition</b> <a href="#l00412">scripting.cpp:412</a></div></div>
<div class="ttc" id="aclass_k_win_1_1_script_html_aec2f16a1931cb76ae63800317f59143f"><div class="ttname"><a href="class_k_win_1_1_script.html#aec2f16a1931cb76ae63800317f59143f">KWin::Script::registerScreenEdge</a></div><div class="ttdeci">Q_INVOKABLE bool registerScreenEdge(int edge, const QJSValue &amp;callback)</div><div class="ttdef"><b>Definition</b> <a href="#l00395">scripting.cpp:395</a></div></div>
<div class="ttc" id="aclass_k_win_1_1_script_timer_html_ae556302e470671be322137dae9cbe0c4"><div class="ttname"><a href="class_k_win_1_1_script_timer.html#ae556302e470671be322137dae9cbe0c4">KWin::ScriptTimer::ScriptTimer</a></div><div class="ttdeci">Q_INVOKABLE ScriptTimer(QObject *parent=nullptr)</div><div class="ttdef"><b>Definition</b> <a href="#l00127">scripting.cpp:127</a></div></div>
<div class="ttc" id="aclass_k_win_1_1_scripting_html"><div class="ttname"><a href="class_k_win_1_1_scripting.html">KWin::Scripting</a></div><div class="ttdef"><b>Definition</b> <a href="scripting_8h_source.html#l00309">scripting.h:310</a></div></div>
<div class="ttc" id="aclass_k_win_1_1_scripting_html_a157a8abdd6f6b334e80f9cd2ba697494"><div class="ttname"><a href="class_k_win_1_1_scripting.html#a157a8abdd6f6b334e80f9cd2ba697494">KWin::Scripting::findScript</a></div><div class="ttdeci">AbstractScript * findScript(const QString &amp;pluginName) const</div><div class="ttdef"><b>Definition</b> <a href="#l00771">scripting.cpp:771</a></div></div>
<div class="ttc" id="aclass_k_win_1_1_scripting_html_a435da48783defd7960eaf079e772459a"><div class="ttname"><a href="class_k_win_1_1_scripting.html#a435da48783defd7960eaf079e772459a">KWin::Scripting::create</a></div><div class="ttdeci">static Scripting * create(QObject *parent)</div><div class="ttdef"><b>Definition</b> <a href="#l00618">scripting.cpp:618</a></div></div>
<div class="ttc" id="aclass_k_win_1_1_scripting_html_a4e2286c762b2e3294fed7cbcfc46453b"><div class="ttname"><a href="class_k_win_1_1_scripting.html#a4e2286c762b2e3294fed7cbcfc46453b">KWin::Scripting::isScriptLoaded</a></div><div class="ttdeci">Q_SCRIPTABLE Q_INVOKABLE bool isScriptLoaded(const QString &amp;pluginName) const</div><div class="ttdef"><b>Definition</b> <a href="#l00766">scripting.cpp:766</a></div></div>
<div class="ttc" id="aclass_k_win_1_1_scripting_html_a82be76e174d5f13e24ee8751ef17fc56"><div class="ttname"><a href="class_k_win_1_1_scripting.html#a82be76e174d5f13e24ee8751ef17fc56">KWin::Scripting::~Scripting</a></div><div class="ttdeci">~Scripting() override</div><div class="ttdef"><b>Definition</b> <a href="#l00834">scripting.cpp:834</a></div></div>
<div class="ttc" id="aclass_k_win_1_1_scripting_html_a86614b2061d94f0aa87c28ffc9f790da"><div class="ttname"><a href="class_k_win_1_1_scripting.html#a86614b2061d94f0aa87c28ffc9f790da">KWin::Scripting::unloadScript</a></div><div class="ttdeci">Q_SCRIPTABLE Q_INVOKABLE bool unloadScript(const QString &amp;pluginName)</div><div class="ttdef"><b>Definition</b> <a href="#l00782">scripting.cpp:782</a></div></div>
<div class="ttc" id="aclass_k_win_1_1_scripting_html_aac1399c98e9a5912716fedbe711eaca4"><div class="ttname"><a href="class_k_win_1_1_scripting.html#aac1399c98e9a5912716fedbe711eaca4">KWin::Scripting::actionsForUserActionMenu</a></div><div class="ttdeci">QList&lt; QAction * &gt; actionsForUserActionMenu(Window *c, QMenu *parent)</div><div class="ttdoc">Invokes all registered callbacks to add actions to the UserActionsMenu.</div><div class="ttdef"><b>Definition</b> <a href="#l00840">scripting.cpp:840</a></div></div>
<div class="ttc" id="aclass_k_win_1_1_scripting_html_acb0eac88b1d79c1718eb83d301493d7a"><div class="ttname"><a href="class_k_win_1_1_scripting.html#acb0eac88b1d79c1718eb83d301493d7a">KWin::Scripting::loadDeclarativeScript</a></div><div class="ttdeci">Q_SCRIPTABLE Q_INVOKABLE int loadDeclarativeScript(const QString &amp;filePath, const QString &amp;pluginName=QString())</div><div class="ttdef"><b>Definition</b> <a href="#l00821">scripting.cpp:821</a></div></div>
<div class="ttc" id="aclass_k_win_1_1_scripting_html_adb86674cfb829b7b89bc88556db9a29f"><div class="ttname"><a href="class_k_win_1_1_scripting.html#adb86674cfb829b7b89bc88556db9a29f">KWin::Scripting::loadScript</a></div><div class="ttdeci">Q_SCRIPTABLE Q_INVOKABLE int loadScript(const QString &amp;filePath, const QString &amp;pluginName=QString())</div><div class="ttdef"><b>Definition</b> <a href="#l00808">scripting.cpp:808</a></div></div>
<div class="ttc" id="aclass_k_win_1_1_scripting_html_ae42e35c69eacf6822dccda0b351fdc84"><div class="ttname"><a href="class_k_win_1_1_scripting.html#ae42e35c69eacf6822dccda0b351fdc84">KWin::Scripting::self</a></div><div class="ttdeci">static Scripting * self()</div><div class="ttdef"><b>Definition</b> <a href="scripting_8h_source.html#l00393">scripting.h:393</a></div></div>
<div class="ttc" id="aclass_k_win_1_1_scripting_html_ae71adccb69f6bedc04645d52245b869a"><div class="ttname"><a href="class_k_win_1_1_scripting.html#ae71adccb69f6bedc04645d52245b869a">KWin::Scripting::scriptDestroyed</a></div><div class="ttdeci">void scriptDestroyed(QObject *object)</div><div class="ttdef"><b>Definition</b> <a href="#l00802">scripting.cpp:802</a></div></div>
<div class="ttc" id="aclass_k_win_1_1_scripting_html_afd37e1362c714de166990156ddf62e8a"><div class="ttname"><a href="class_k_win_1_1_scripting.html#afd37e1362c714de166990156ddf62e8a">KWin::Scripting::start</a></div><div class="ttdeci">Q_SCRIPTABLE void start()</div><div class="ttdef"><b>Definition</b> <a href="#l00675">scripting.cpp:675</a></div></div>
<div class="ttc" id="aclass_k_win_1_1_window_html"><div class="ttname"><a href="class_k_win_1_1_window.html">KWin::Window</a></div><div class="ttdef"><b>Definition</b> <a href="window_8h_source.html#l00060">window.h:61</a></div></div>
<div class="ttc" id="aclass_k_win_1_1_workspace_html_a21cf494fbdd48523724bd6f35bf5547e"><div class="ttname"><a href="class_k_win_1_1_workspace.html#a21cf494fbdd48523724bd6f35bf5547e">KWin::Workspace::screenEdges</a></div><div class="ttdeci">ScreenEdges * screenEdges() const</div><div class="ttdef"><b>Definition</b> <a href="workspace_8cpp_source.html#l03063">workspace.cpp:3063</a></div></div>
<div class="ttc" id="aclass_k_win_1_1_workspace_html_a40a0c2857a176b5288406b0aaa5b79d6"><div class="ttname"><a href="class_k_win_1_1_workspace.html#a40a0c2857a176b5288406b0aaa5b79d6">KWin::Workspace::workspaceInitialized</a></div><div class="ttdeci">void workspaceInitialized()</div></div>
<div class="ttc" id="aclass_k_win_1_1_workspace_html_a8ca8f8a3904f007fd6a256c0d6996201"><div class="ttname"><a href="class_k_win_1_1_workspace.html#a8ca8f8a3904f007fd6a256c0d6996201">KWin::Workspace::self</a></div><div class="ttdeci">static Workspace * self()</div><div class="ttdef"><b>Definition</b> <a href="workspace_8h_source.html#l00091">workspace.h:91</a></div></div>
<div class="ttc" id="aclass_k_win_1_1_workspace_html_abd94bbc1291ecb4698c459980e158ace"><div class="ttname"><a href="class_k_win_1_1_workspace.html#abd94bbc1291ecb4698c459980e158ace">KWin::Workspace::configChanged</a></div><div class="ttdeci">void configChanged()</div></div>
<div class="ttc" id="aclass_q_future_watcher_html"><div class="ttname"><a href="class_q_future_watcher.html">QFutureWatcher</a></div><div class="ttdef"><b>Definition</b> <a href="client__machine_8h_source.html#l00018">client_machine.h:18</a></div></div>
<div class="ttc" id="acore_2output_8h_html"><div class="ttname"><a href="core_2output_8h.html">output.h</a></div></div>
<div class="ttc" id="adbuscall_8h_html"><div class="ttname"><a href="dbuscall_8h.html">dbuscall.h</a></div></div>
<div class="ttc" id="adesktopbackgrounditem_8h_html"><div class="ttname"><a href="desktopbackgrounditem_8h.html">desktopbackgrounditem.h</a></div></div>
<div class="ttc" id="agesturehandler_8h_html"><div class="ttname"><a href="gesturehandler_8h.html">gesturehandler.h</a></div></div>
<div class="ttc" id="ainput_8h_html"><div class="ttname"><a href="input_8h.html">input.h</a></div></div>
<div class="ttc" id="anamespace_k_win_html_a19449039799dcafb994719a68964b51e"><div class="ttname"><a href="namespace_k_win.html#a19449039799dcafb994719a68964b51e">KWin::dbusToVariant</a></div><div class="ttdeci">QVariant dbusToVariant(const QVariant &amp;variant)</div><div class="ttdef"><b>Definition</b> <a href="scriptingutils_8cpp_source.html#l00019">scriptingutils.cpp:19</a></div></div>
<div class="ttc" id="anamespace_k_win_html_a7eda12963fb07e3df0c1f337e8526bc5"><div class="ttname"><a href="namespace_k_win.html#a7eda12963fb07e3df0c1f337e8526bc5">KWin::ElectricBorder</a></div><div class="ttdeci">ElectricBorder</div><div class="ttdef"><b>Definition</b> <a href="globals_8h_source.html#l00060">globals.h:60</a></div></div>
<div class="ttc" id="anamespace_k_win_html_a8700e164bd811b5f862b944a87bb9b85"><div class="ttname"><a href="namespace_k_win.html#a8700e164bd811b5f862b944a87bb9b85">KWin::workspace</a></div><div class="ttdeci">Workspace * workspace()</div><div class="ttdef"><b>Definition</b> <a href="workspace_8h_source.html#l00830">workspace.h:830</a></div></div>
<div class="ttc" id="anamespace_k_win_html_aacddce7916a99bb943d9071c40754c1c"><div class="ttname"><a href="namespace_k_win.html#aacddce7916a99bb943d9071c40754c1c">KWin::options</a></div><div class="ttdeci">Options * options</div><div class="ttdef"><b>Definition</b> <a href="main_8cpp_source.html#l00073">main.cpp:73</a></div></div>
<div class="ttc" id="aoptions_8h_html"><div class="ttname"><a href="options_8h.html">options.h</a></div></div>
<div class="ttc" id="aquickeffect_8h_html"><div class="ttname"><a href="quickeffect_8h.html">quickeffect.h</a></div></div>
<div class="ttc" id="ascreenedge_8h_html"><div class="ttname"><a href="screenedge_8h.html">screenedge.h</a></div></div>
<div class="ttc" id="ascreenedgehandler_8h_html"><div class="ttname"><a href="screenedgehandler_8h.html">screenedgehandler.h</a></div></div>
<div class="ttc" id="ascriptedquicksceneeffect_8h_html"><div class="ttname"><a href="scriptedquicksceneeffect_8h.html">scriptedquicksceneeffect.h</a></div></div>
<div class="ttc" id="ascripting_8h_html"><div class="ttname"><a href="scripting_8h.html">scripting.h</a></div></div>
<div class="ttc" id="ascripting_8h_html_afb5c13d7e637b8983a9e532a0b6dcbfe"><div class="ttname"><a href="scripting_8h.html#afb5c13d7e637b8983a9e532a0b6dcbfe">LoadScriptList</a></div><div class="ttdeci">QList&lt; QPair&lt; bool, QPair&lt; QString, QString &gt; &gt; &gt; LoadScriptList</div><div class="ttdoc">true == javascript, false == qml</div><div class="ttdef"><b>Definition</b> <a href="scripting_8h_source.html#l00035">scripting.h:35</a></div></div>
<div class="ttc" id="ascripting__logging_8h_html"><div class="ttname"><a href="scripting__logging_8h.html">scripting_logging.h</a></div></div>
<div class="ttc" id="ascriptingutils_8h_html"><div class="ttname"><a href="scriptingutils_8h.html">scriptingutils.h</a></div></div>
<div class="ttc" id="ashortcuthandler_8h_html"><div class="ttname"><a href="shortcuthandler_8h.html">shortcuthandler.h</a></div></div>
<div class="ttc" id="atilemanager_8h_html"><div class="ttname"><a href="tilemanager_8h.html">tilemanager.h</a></div></div>
<div class="ttc" id="avirtualdesktopmodel_8h_html"><div class="ttname"><a href="virtualdesktopmodel_8h.html">virtualdesktopmodel.h</a></div></div>
<div class="ttc" id="awindowmodel_8h_html"><div class="ttname"><a href="windowmodel_8h.html">windowmodel.h</a></div></div>
<div class="ttc" id="awindowthumbnailitem_8h_html"><div class="ttname"><a href="windowthumbnailitem_8h.html">windowthumbnailitem.h</a></div></div>
<div class="ttc" id="aworkspace_8h_html"><div class="ttname"><a href="workspace_8h.html">workspace.h</a></div></div>
<div class="ttc" id="aworkspace__wrapper_8h_html"><div class="ttname"><a href="workspace__wrapper_8h.html">workspace_wrapper.h</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sat Feb 17 2024 01:42:10 for KWin by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0
</small></address>
</body>
</html>
